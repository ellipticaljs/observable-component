!function(e,t){"undefined"!=typeof module&&module.exports?module.exports=t():"function"==typeof define&&define.amd?define([],t):e.returnExports=t()}(this,function(){Object.observe||!function(e,t){"use strict";var n=function(e){var n=e.call(e),r=typeof r;return"object"==typeof t.alert?function(t){return n===e.call(t)||!!t&&typeof t.toString==r&&typeof t.valueOf==r&&/^\s*\bfunction\b/.test(""+t)}:function(t){return n===e.call(t)}}(e.prototype.toString),r=function(e){return"object"==typeof HTMLElement?e instanceof HTMLElement:e&&"object"==typeof e&&null!==e&&1===e.nodeType&&"string"==typeof e.nodeName},i=function(e){setTimeout(e,10)},o=function(e){clearTimeout(e)},s=function(e){return!isNaN(parseFloat(e))&&isFinite(e)},a=function(e,t){return e===t?0!==e||1/e===1/t:e!==e&&t!==t},c=function(e){return"undefined"==typeof e?!1:"get"in e||"set"in e},u=function(e,t){var n=!1;return e.forEach(function(e){e===t&&(n=!0)}),n},l=function(e,t,r){if("object"!=typeof e)throw new TypeError("Object.observeObject called on non-object");if(n(t)===!1)throw new TypeError("Object.observeObject: Expecting function");if(Object.isFrozen(t)===!0)throw new TypeError("Object.observeObject: Expecting unfrozen function");if(void 0!==r&&!Array.isArray(r))throw new TypeError("Object.observeObject: Expecting acceptList in the form of an array")},d=function v(){var e=[],v=function n(t,r,i){Array.isArray(t)&&(n._oldValue=t.concat([])),l(t,r,i),i||(i=["add","update","delete","slice"]),Object.getNotifier(t).addListener(r,i),-1===e.indexOf(t)?e.push(t):Object.getNotifier(t)._checkPropertyListing()};v.prototype.deliverChangeRecords=function(e){Object.getNotifier(e).deliverChangeRecords()},e.lastScanned=0;var t=function(e){return function t(){var n=0,r=e.length,o=new Date,s=!1;for(n=e.lastScanned;r>n&&!s;n++)p.indexOf(e[n])>-1?(Object.getNotifier(e[n])._checkPropertyListing(),s=new Date-o>500):(e.splice(n,1),n--,r--);e.lastScanned=r>n?n:0,i(t)}}(e);return i(t),v}(),h=function(e){var t=[],n=[],r=[],l=!1,h=[],f=[],p=this;Object.defineProperty(p,"_watching",{enumerable:!0,get:function(e){return function(){return e}}(e)});var v=function(e,t){var n=(typeof e[t],Object.getOwnPropertyDescriptor(e,t));if("getNotifier"===t||c(n)||!n.enumerable)return!1;if(e instanceof Array&&s(t)){var r=h.length;return h[r]=t,f[r]=e[t],!0}return function(t,n){h[t]=n,f[t]=e[n],Object.defineProperty(e,n,{get:function(){return f[t]},set:function(r){a(f[t],r)||(Object.getNotifier(e).queueUpdate(e,n,"update",f[t]),f[t]=r)}})}(h.length,t),!0};p._checkPropertyListing=function(e){var t,n,r,i,o,a=p._watching,c=Object.keys(a),u=0,l=c.length,d=h.slice(0),b=!e;for(a instanceof Array&&(o=p._oldLength),u=0;l>u;u++)t=c[u],r=a[t],n=typeof r,-1===(i=h.indexOf(t))?v(a,t)&&b&&p.queueUpdate(a,t,"add",null,a[t]):(a instanceof Array&&!s(t)||f[i]!==r&&(b&&p.queueUpdate(a,t,"update",f[i],r),f[i]=r),d.splice(d.indexOf(t),1));if(a instanceof Array&&a.length!==o&&(b&&p.queueUpdate(a,"length","update",o,a),p._oldLength=a.length),b)for(l=d.length,u=0;l>u;u++)i=h.indexOf(d[u]),p.queueUpdate(a,d[u],"delete",f[i]),h.splice(i,1),f.splice(i,1)},p.addListener=function(e,r){var i=t.indexOf(e);-1===i?(t.push(e),n.push(r)):n[i]=r},p.removeListener=function(e){var r=t.indexOf(e);r>-1&&(t.splice(r,1),n.splice(r,1))},p.listeners=function(){return t},p.queueUpdate=function(e,t,n,r){this.queueUpdates([{type:n,object:e,name:t,oldValue:r}])},p.queueUpdates=function(e){var t,n=this,s=0,a=e.length||0;for(s=0;a>s;s++)t=e[s],r.push(t);l&&o(l),l=i(function(){l=!1,n.deliverChangeRecords()})},p.deliverChangeRecords=function(){var e=0,i=t.length;for(e=0;i>e;e++)if(t[e]){var o;if(n[e]){o=[];for(var s=0,a=r.length;a>s;s++)-1!==n[e].indexOf(r[s].type)&&o.push(r[s])}else o=r;if(o.length){if(u(n[e],"splice")){var c=p._arrayObserverSplice(o);o=c?c:o}t[e]===console.log?console.log(o):t[e](o)}}r=[]},p.notify=function(t){if("object"!=typeof t||"string"!=typeof t.type)throw new TypeError("Invalid changeRecord with non-string 'type' property");t.object=e,p.queueUpdates([t])},p._checkPropertyListing(!0),p._arrayObserverSplice=function(e){var t=e[0].object;if(!Array.isArray(t))return!1;var n=d._oldValue;if(void 0===n)return!1;var r=n.length,i=t.length;if(i===r)return!1;var o=p._spliceChangeRecord();o.object=t;var s=r-1,a=i-1;if(i>r){if(o.addedCount=i-r,n[s]!==t[a])o.index=s+1;else if(n[0]!==t[0])o.index=0;else for(var c=0;r>c;c++)if(n[c]!==t[c]){o.index=c;break}}else{var u=r-i;if(n[s]!==t[a])o.index=a+1;else if(n[0]!==t[0])o.index=0;else for(var c=0;r>c;c++)if(n[c]!==t[c]){o.index=c;break}o.removed=p._removedArray(n,o.index,u)}return d._oldValue=t.concat([]),[o]},p._spliceChangeRecord=function(){return{addedCount:0,index:void 0,object:[],removed:[],type:"splice"}},p._removedArray=function(e,t,n){for(var r=[],i=t+n,o=t;i>o;o++)r.push(e[o]);return r}},f=[],p=[];e.getNotifier=function(e){var t=p.indexOf(e),n=t>-1?f[t]:!1;return n||(t=p.length,p[t]=e,n=f[t]=new h(e)),n},e.observe=function(e,t,n){return r(e)?void 0:new d(e,t,n)},e.unobserve=function(e,t){l(e,t);var n=p.indexOf(e),r=n>-1?f[n]:!1;r&&(r.removeListener(t),0===r.listeners().length&&(p.splice(n,1),f.splice(n,1)))}}(Object,this)}),function(e,t){"undefined"!=typeof module&&module.exports?module.exports=t():"function"==typeof define&&define.amd?define([],t):(e._utils=e._utils||{},e._utils.forEach=t(),e.returnExports=e._utils.forEach)}(this,function(){var e=Object.prototype.hasOwnProperty,t=Object.prototype.toString;return function(n,r,i){if("[object Function]"!==t.call(r))throw new TypeError("iterator must be a function");var o=n.length;if(o===+o)for(var s=0;o>s;s++)r.call(i,n[s],s,n);else for(var a in n)e.call(n,a)&&r.call(i,n[a],a,n)}}),function(e,t){"undefined"!=typeof module&&module.exports?module.exports=t(require("foreach")):"function"==typeof define&&define.amd?define(["foreach"],t):(e._utils.jsonPointer=t(e._utils.forEach),e.returnExports=e._utils.jsonPointer)}(this,function(e){function t(e,n,r){if(3===arguments.length)return t.set(e,n,r);if(2===arguments.length)return t.get(e,n);var i=t.bind(t,e);for(var o in t)t.hasOwnProperty(o)&&(i[o]=t[o].bind(i,e));return i}var n=e;return t.get=function(e,n){for(var r,i=t.parse(n);i.length;){if(r=i.shift(),!e.hasOwnProperty(r))throw new Error("Invalid reference token: "+r);e=e[r]}return e},t.set=function(e,n,r){for(var i,o=t.parse(n),s=o[0];o.length>1;)i=o.shift(),s=o[0],e.hasOwnProperty(i)||(s.match(/^\d+$/)?e[i]=[]:e[i]={}),e=e[i];return e[s]=r,this},t.remove=function(e,n){var r=t.parse(n),i=r.pop();if(void 0===i)throw new Error('Invalid JSON pointer for remove: "'+n+'"');delete t.get(e,t.compile(r))[i]},t.dict=function(e,n){var r={};return t.walk(e,function(e,t){r[t]=e},n),r},t.walk=function(e,r,i){var o=[];i=i||function(e){var t=Object.prototype.toString.call(e);return"[object Object]"===t||"[object Array]"===t},function s(e){n(e,function(e,n){o.push(String(n)),i(e)?s(e):r(e,t.compile(o)),o.pop()})}(e)},t.has=function(e,n){try{t.get(e,n)}catch(r){return!1}return!0},t.escape=function(e){return e.toString().replace(/~/g,"~0").replace(/\//g,"~1")},t.unescape=function(e){return e.replace(/~1/g,"/").replace(/~0/g,"~")},t.parse=function(e){if(""===e)return[];if("/"!==e.charAt(0))throw new Error("Invalid JSON pointer: "+e);return e.substring(1).split(/\//).map(t.unescape)},t.compile=function(e){return 0===e.length?"":"/"+e.map(t.escape).join("/")},t}),function(e,t){"undefined"!=typeof module&&module.exports?module.exports=t(require("json-pointer")):"function"==typeof define&&define.amd?define(["json-pointer"],t):(e.Nested=t(e._utils.jsonPointer),e.returnExports=e.Nested)}(this,function(e){function t(e,t,n){return e.has(t)?-1!==e.get(t).indexOf(n):!1}function n(e,t,n){var r=(!e.has(t)&&e.set(t,[]),e.get(t));r.push(n)}function r(e,t,n){var r=e.get(t),i=r.indexOf(n);r.splice(i,1),r.length||e["delete"](t)}var i=e,o=Object.create(null),s=new WeakMap,a=function(e){this.callback=e,this.observers=new WeakMap;var t=this;this.handleChangeRecords=function(e){try{var n=e.map(t.transform,t);n=Array.prototype.concat.apply([],n),t.callback(n)}catch(r){o.debug&&console.error(r.stack)}}};a.prototype.transform=function(e){var t=this.observers.get(e.object);return t=t.filter(function(e,t,n){return n.indexOf(e)===t}),t.map(function(t){return t.transform(e)})};var c=function(e,t,n){this.root=e,this.delegate=t,this.callback=t.handleChangeRecords,this.accept=n,this.paths=new WeakMap};return c.prototype.observe=function(e,r,o){if(r||(r=""),o||(o=new WeakMap),!o.has(e)){o.set(e,!0),t(this.delegate.observers,e,this)||(Array.isArray(e)&&!this.accept?Object.observe(e,this.callback,["add","update","delete","splice"]):Object.observe(e,this.callback,this.accept)),n(this.paths,e,r),n(this.delegate.observers,e,this);for(var s in e)"object"==typeof e[s]&&null!==e[s]&&this.observe(e[s],r+"/"+i.escape(s),o)}},c.prototype.unobserve=function(e,n){if(console.log(n),e||(e=this.root),n||(n=""),t(this.delegate.observers,e,this)){r(this.paths,e,n),r(this.delegate.observers,e,this),this.paths.has(e)||Object.unobserve(e,this.callback);for(var o in e)"object"==typeof e[o]&&this.unobserve(e[o],n+"/"+i.escape(o))}},c.prototype.transform=function(e){var t=String(e.name||e.index),n=this.paths.get(e.object)[0]+"/"+i.escape(t),r={root:this.root,path:n};for(var o in e)r[o]=e[o];var s=e.oldValue&&[e.oldValue]||e.removed||[];s.forEach(function(e){if(e&&"object"==typeof e){this.paths.get(e).filter(function(t){return!i.has(this.root,t)||i.get(this.root,t)!==e},this)}},this);var a=e.object[t];if("object"==typeof a){var c=Object.getOwnPropertyDescriptor(e.object,t);c.enumerable===!0?this.observe(a,n):this.unobserve(a,n)}return Object.preventExtensions(r),r},o.observe=function(e,t,n){if(void 0===e||"object"!=typeof e)return!1;var r;s.has(t)?r=s.get(t):(r=new a(t),s.set(t,r));var i=r.observers;if(!i.has(e)){var o=new c(e,r,n);o.observe(e)}},o.unobserve=function(e,t){if(s.has(t)){var n=s.get(t);if(n.observers.has(e)){console.log("nested unobserve");var r=n.observers.get(e);r.forEach(function(e){e.unobserve()})}}},o.deliverChangeRecords=function(e){if("function"!=typeof e)throw new TypeError("Callback must be a function, given: "+e);if(s.has(e)){var t=s.get(e);Object.deliverChangeRecords(t.handleChangeRecords)}},o.debug=!1,o}),function(e){"use strict";function t(){function e(e){t=e}if("function"!=typeof Object.observe||"function"!=typeof Array.observe)return!1;var t=[],n={},r=[];return Object.observe(n,e),Array.observe(r,e),n.id=1,n.id=2,delete n.id,r.push(1,2),r.length=0,Object.deliverChangeRecords(e),5!==t.length?!1:"add"!=t[0].type||"update"!=t[1].type||"delete"!=t[2].type||"splice"!=t[3].type||"splice"!=t[4].type?!1:(Object.unobserve(n,e),Array.unobserve(r,e),!0)}function n(){if("undefined"!=typeof chrome&&chrome.app&&chrome.app.runtime)return!1;if("undefined"!=typeof navigator&&navigator.getDeviceStorage)return!1;try{var e=new Function("","return true;");return e()}catch(t){return!1}}function r(e){return+e===e>>>0&&""!==e}function i(e){return+e}function o(e){return e===Object(e)}function s(e,t){return e===t?0!==e||1/e===1/t:U(e)&&U(t)?!0:e!==e&&t!==t}function a(e){if(void 0===e)return"eof";var t=e.charCodeAt(0);switch(t){case 91:case 93:case 46:case 34:case 39:case 48:return e;case 95:case 36:return"ident";case 32:case 9:case 10:case 13:case 160:case 65279:case 8232:case 8233:return"ws"}return t>=97&&122>=t||t>=65&&90>=t?"ident":t>=49&&57>=t?"number":"else"}function c(){}function u(e){function t(){if(!(h>=e.length)){var t=e[h+1];return"inSingleQuote"==f&&"'"==t||"inDoubleQuote"==f&&'"'==t?(h++,r=t,p.append(),!0):void 0}}for(var n,r,i,o,s,u,l,d=[],h=-1,f="beforePath",p={push:function(){void 0!==i&&(d.push(i),i=void 0)},append:function(){void 0===i?i=r:i+=r}};f;)if(h++,n=e[h],"\\"!=n||!t(f)){if(o=a(n),l=J[f],s=l[o]||l["else"]||"error","error"==s)return;if(f=s[0],u=p[s[1]]||c,r=void 0===s[2]?n:s[2],u(),"afterPath"===f)return d}}function l(e){return z.test(e)}function d(e,t){if(t!==Z)throw Error("Use Path.get to retrieve path objects");for(var n=0;n<e.length;n++)this.push(String(e[n]));B&&this.length&&(this.getValueFrom=this.compiledGetValueFromFn())}function h(e){if(e instanceof d)return e;if((null==e||0==e.length)&&(e=""),"string"!=typeof e){if(r(e.length))return new d(e,Z);e=String(e)}var t=G[e];if(t)return t;var n=u(e);return n?(t=new d(n,Z),G[e]=t,t):K}function f(e){return r(e)?"["+e+"]":'["'+e.replace(/"/g,'\\"')+'"]'}function p(t){for(var n=0;Y>n&&t.check_();)n++;return D&&(e.dirtyCheckCycleCount=n),n>0}function v(e){for(var t in e)return!1;return!0}function b(e){return v(e.added)&&v(e.removed)&&v(e.changed)}function _(e,t){var n,r={},i={},o={};for(n in t){var s=e[n];(void 0===s||s!==t[n])&&(n in e?s!==t[n]&&(o[n]=s):i[n]=void 0)}for(n in e)n in t||(r[n]=e[n]);return Array.isArray(e)&&e.length!==t.length&&(o.length=e.length),{added:r,removed:i,changed:o}}function g(){if(!ee.length)return!1;for(var e=0;e<ee.length;e++)ee[e]();return ee.length=0,!0}function y(){function e(e){t&&t.state_===oe&&!r&&t.check_(e)}var t,n,r=!1,i=!0;return{open:function(n){if(t)throw Error("ObservedObject in use");i||Object.deliverChangeRecords(e),t=n,i=!1},observe:function(t,r){n=t,r?Array.observe(n,e):Object.observe(n,e)},deliver:function(t){r=t,Object.deliverChangeRecords(e),r=!1},close:function(){t=void 0,Object.unobserve(n,e),ne.push(this)}}}function m(e,t,n){var r=ne.pop()||y();return r.open(e),r.observe(t,n),r}function O(){function e(t,o){t&&(t===r&&(i[o]=!0),a.indexOf(t)<0&&(a.push(t),Object.observe(t,n)),e(Object.getPrototypeOf(t),o))}function t(e){for(var t=0;t<e.length;t++){var n=e[t];if(n.object!==r||i[n.name]||"setPrototype"===n.type)return!1}return!0}function n(n){if(!t(n)){var r,i;for(r=0;r<s.length;r++)i=s[r],i.state_==oe&&i.iterateObjects_(e);for(r=0;r<s.length;r++)i=s[r],i.state_==oe&&i.check_()}}var r,i,o=0,s=[],a=[],c={objects:a,get rootObject(){return r},set rootObject(e){r=e,i={}},open:function(t,n){s.push(t),o++,t.iterateObjects_(e)},close:function(e){if(o--,!(o>0)){for(var t=0;t<a.length;t++)Object.unobserve(a[t],n),x.unobservedCount++;s.length=0,a.length=0,r=void 0,i=void 0,re.push(this),X===this&&(X=null)}}};return c}function j(e,t){return X&&X.rootObject===t||(X=re.pop()||O(),X.rootObject=t),X.open(e,t),X}function x(){this.state_=ie,this.callback_=void 0,this.target_=void 0,this.directObserver_=void 0,this.value_=void 0,this.id_=ce++}function w(e){x._allObserversCount++,le&&ue.push(e)}function E(e){x._allObserversCount--}function C(e){x.call(this),this.value_=e,this.oldObject_=void 0}function P(e){if(!Array.isArray(e))throw Error("Provided object is not an Array");C.call(this,e)}function k(e,t,n){x.call(this),this.object_=e,this.path_=h(t),this.defaultValue_=n,this.directObserver_=void 0}function A(e){x.call(this),this.reportChangesOnOpen_=e,this.value_=[],this.directObserver_=void 0,this.observed_=[]}function S(e){return e}function V(e,t,n,r){this.callback_=void 0,this.target_=void 0,this.value_=void 0,this.observable_=e,this.getValueFn_=t||S,this.setValueFn_=n||S,this.dontPassThroughSet_=r}function T(e,t,n){for(var r={},i={},o=0;o<t.length;o++){var s=t[o];fe[s.type]?(s.name in n||(n[s.name]=s.oldValue),"update"!=s.type&&("add"!=s.type?s.name in r?(delete r[s.name],delete n[s.name]):i[s.name]=!0:s.name in i?delete i[s.name]:r[s.name]=!0)):(console.error("Unknown changeRecord type: "+s.type),console.error(s))}var a;for(a in r)r[a]=e[a];for(a in i)i[a]=void 0;var c={};for(a in n)if(!(a in r||a in i)){var u=e[a];n[a]!==u&&(c[a]=u)}return{added:r,removed:i,changed:c}}function N(e,t,n){return{index:e,removed:t,addedCount:n}}function I(){}function R(e,t,n,r,i,o){return ge.calcSplices(e,t,n,r,i,o)}function F(e,t,n,r){return n>t||e>r?-1:t==n||r==e?0:n>e?r>t?t-n:r-n:t>r?r-e:t-e}function M(e,t,n,r){for(var i=N(t,n,r),o=!1,s=0,a=0;a<e.length;a++){var c=e[a];if(c.index+=s,!o){var u=F(i.index,i.index+i.removed.length,c.index,c.index+c.addedCount);if(u>=0){e.splice(a,1),a--,s-=c.addedCount-c.removed.length,i.addedCount+=c.addedCount-u;var l=i.removed.length+c.removed.length-u;if(i.addedCount||l){if(n=c.removed,i.index<c.index){var d=i.removed.slice(0,c.index-i.index);Array.prototype.push.apply(d,n),n=d}if(i.index+i.removed.length>c.index+c.addedCount){var h=i.removed.slice(c.index+c.addedCount-i.index);Array.prototype.push.apply(n,h)}i.removed=n,c.index<i.index&&(i.index=c.index)}else o=!0}else if(i.index<c.index){o=!0,e.splice(a,0,i),a++;var f=i.addedCount-i.removed.length;c.index+=f,s+=f}}}o||e.push(i)}function $(e,t){for(var n=[],o=0;o<t.length;o++){var s=t[o];switch(s.type){case"splice":M(n,s.index,s.removed.slice(),s.addedCount);break;case"add":case"update":case"delete":if(!r(s.name))continue;var a=i(s.name);if(0>a)continue;M(n,a,[s.oldValue],1);break;default:console.error("Unexpected record type: "+JSON.stringify(s))}}return n}function L(e,t){var n=[];return $(e,t).forEach(function(t){return 1==t.addedCount&&1==t.removed.length?void(t.removed[0]!==e[t.index]&&n.push(t)):void(n=n.concat(R(e,t.index,t.index+t.addedCount,t.removed,0,t.removed.length)))}),n}var D=e.testingExposeCycleCount,q=t(),B=n(),U=e.Number.isNaN||function(t){return"number"==typeof t&&e.isNaN(t)},H="__proto__"in{}?function(e){return e}:function(e){var t=e.__proto__;if(!t)return e;var n=Object.create(t);return Object.getOwnPropertyNames(e).forEach(function(t){Object.defineProperty(n,t,Object.getOwnPropertyDescriptor(e,t))}),n},Q="[$_a-zA-Z]",W="[$_a-zA-Z0-9]",z=new RegExp("^"+Q+"+"+W+"*$"),J={beforePath:{ws:["beforePath"],ident:["inIdent","append"],"[":["beforeElement"],eof:["afterPath"]},inPath:{ws:["inPath"],".":["beforeIdent"],"[":["beforeElement"],eof:["afterPath"]},beforeIdent:{ws:["beforeIdent"],ident:["inIdent","append"]},inIdent:{ident:["inIdent","append"],0:["inIdent","append"],number:["inIdent","append"],ws:["inPath","push"],".":["beforeIdent","push"],"[":["beforeElement","push"],eof:["afterPath","push"]},beforeElement:{ws:["beforeElement"],0:["afterZero","append"],number:["inIndex","append"],"'":["inSingleQuote","append",""],'"':["inDoubleQuote","append",""]},afterZero:{ws:["afterElement","push"],"]":["inPath","push"]},inIndex:{0:["inIndex","append"],number:["inIndex","append"],ws:["afterElement"],"]":["inPath","push"]},inSingleQuote:{"'":["afterElement"],eof:["error"],"else":["inSingleQuote","append"]},inDoubleQuote:{'"':["afterElement"],eof:["error"],"else":["inDoubleQuote","append"]},afterElement:{ws:["afterElement"],"]":["inPath","push"]}},Z={},G={};d.get=h,d.prototype=H({__proto__:[],valid:!0,toString:function(){for(var e="",t=0;t<this.length;t++){var n=this[t];e+=l(n)?t?"."+n:n:f(n)}return e},getValueFrom:function(e,t){for(var n=0;n<this.length;n++){var r=this[n];if(null==e||!(r in e))return t;e=e[r]}return e},iterateObjects:function(e,t){for(var n=0;n<this.length;n++){if(n&&(e=e[this[n-1]]),!o(e))return;t(e,this[n])}},compiledGetValueFromFn:function(){var e="",t="obj";e+="if (obj != null";for(var n,r=0;r<this.length-1;r++)n=this[r],t+=l(n)?"."+n:f(n),e+=" &&\n    "+t+" != null";n=this[r];var i=l(n),o=i?'"'+n.replace(/"/g,'\\"')+'"':n;return e+=" &&\n    "+o+" in "+t+")\n",t+=i?"."+n:f(n),e+="  return "+t+";\nelse\n  return defaultValue;",new Function("obj","defaultValue",e)},setValueFrom:function(e,t){if(!this.length)return!1;for(var n=0;n<this.length-1;n++){if(!o(e))return!1;e=e[this[n]]}return o(e)?(e[this[n]]=t,!0):!1}});var K=new d("",Z);K.valid=!1,K.getValueFrom=K.setValueFrom=function(){};var X,Y=1e3,ee=[],te=q?function(){return function(e){return Promise.resolve().then(e)}}():function(){return function(e){ee.push(e)}}(),ne=[],re=[],ie=0,oe=1,se=2,ae=3,ce=1;x.prototype={open:function(e,t){if(this.state_!=ie)throw Error("Observer has already been opened.");return w(this),this.callback_=e,this.target_=t,this.connect_(),this.state_=oe,this.value_},close:function(){this.state_==oe&&(E(this),this.disconnect_(),this.value_=void 0,this.callback_=void 0,this.target_=void 0,this.state_=se)},deliver:function(){this.state_==oe&&p(this)},report_:function(e){try{this.callback_.apply(this.target_,e)}catch(t){x._errorThrownDuringCallback=!0,console.error("Exception caught during observer callback: "+(t.stack||t))}},discardChanges:function(){return this.check_(void 0,!0),this.value_}};var ue,le=!q;x._allObserversCount=0,le&&(ue=[]);var de=!1;e.Platform=e.Platform||{},e.Platform.performMicrotaskCheckpoint=function(){if(!de&&le){de=!0;var t,n,r=0;do{r++,n=ue,ue=[],t=!1;for(var i=0;i<n.length;i++){var o=n[i];o.state_==oe&&(o.check_()&&(t=!0),ue.push(o))}g()&&(t=!0)}while(Y>r&&t);D&&(e.dirtyCheckCycleCount=r),de=!1}},le&&(e.Platform.clearObservers=function(){ue=[]}),C.prototype=H({__proto__:x.prototype,arrayObserve:!1,connect_:function(e,t){q?this.directObserver_=m(this,this.value_,this.arrayObserve):this.oldObject_=this.copyObject(this.value_)},copyObject:function(e){var t=Array.isArray(e)?[]:{};for(var n in e)t[n]=e[n];return Array.isArray(e)&&(t.length=e.length),t},check_:function(e,t){var n,r;if(q){if(!e)return!1;r={},n=T(this.value_,e,r)}else r=this.oldObject_,n=_(this.value_,this.oldObject_);return b(n)?!1:(q||(this.oldObject_=this.copyObject(this.value_)),this.report_([n.added||{},n.removed||{},n.changed||{},function(e){return r[e]}]),!0)},disconnect_:function(){q?(this.directObserver_.close(),this.directObserver_=void 0):this.oldObject_=void 0},deliver:function(){this.state_==oe&&(q?this.directObserver_.deliver(!1):p(this))},discardChanges:function(){return this.directObserver_?this.directObserver_.deliver(!0):this.oldObject_=this.copyObject(this.value_),this.value_}}),P.prototype=H({__proto__:C.prototype,arrayObserve:!0,copyObject:function(e){return e.slice()},check_:function(e){var t;if(q){if(!e)return!1;t=L(this.value_,e)}else t=R(this.value_,0,this.value_.length,this.oldObject_,0,this.oldObject_.length);return t&&t.length?(q||(this.oldObject_=this.copyObject(this.value_)),this.report_([t]),!0):!1}}),P.applySplices=function(e,t,n){n.forEach(function(n){for(var r=[n.index,n.removed.length],i=n.index;i<n.index+n.addedCount;)r.push(t[i]),i++;Array.prototype.splice.apply(e,r)})},k.prototype=H({__proto__:x.prototype,get path(){return this.path_},connect_:function(){q&&(this.directObserver_=j(this,this.object_)),this.check_(void 0,!0)},disconnect_:function(){this.value_=void 0,this.directObserver_&&(this.directObserver_.close(this),this.directObserver_=void 0)},iterateObjects_:function(e){this.path_.iterateObjects(this.object_,e)},check_:function(e,t){var n=this.value_;return this.value_=this.path_.getValueFrom(this.object_,this.defaultValue_),t||s(this.value_,n)?!1:(this.report_([this.value_,n,this]),!0)},setValue:function(e){this.path_&&this.path_.setValueFrom(this.object_,e)}});var he={};A.prototype=H({__proto__:x.prototype,connect_:function(){if(q){for(var e,t=!1,n=0;n<this.observed_.length;n+=2)if(e=this.observed_[n],e!==he){t=!0;break}t&&(this.directObserver_=j(this,e))}this.check_(void 0,!this.reportChangesOnOpen_)},disconnect_:function(){for(var e=0;e<this.observed_.length;e+=2)this.observed_[e]===he&&this.observed_[e+1].close();this.observed_.length=0,this.value_.length=0,this.directObserver_&&(this.directObserver_.close(this),this.directObserver_=void 0)},addPath:function(e,t){if(this.state_!=ie&&this.state_!=ae)throw Error("Cannot add paths once started.");if(t=h(t),this.observed_.push(e,t),this.reportChangesOnOpen_){var n=this.observed_.length/2-1;this.value_[n]=t.getValueFrom(e)}},addObserver:function(e){if(this.state_!=ie&&this.state_!=ae)throw Error("Cannot add observers once started.");if(this.observed_.push(he,e),this.reportChangesOnOpen_){var t=this.observed_.length/2-1;this.value_[t]=e.open(this.deliver,this)}},startReset:function(){if(this.state_!=oe)throw Error("Can only reset while open");this.state_=ae,this.disconnect_()},finishReset:function(){if(this.state_!=ae)throw Error("Can only finishReset after startReset");return this.state_=oe,this.connect_(),this.value_},iterateObjects_:function(e){for(var t,n=0;n<this.observed_.length;n+=2)t=this.observed_[n],t!==he&&this.observed_[n+1].iterateObjects(t,e)},check_:function(e,t){for(var n,r=0;r<this.observed_.length;r+=2){var i,o=this.observed_[r],a=this.observed_[r+1];if(o===he){var c=a;i=this.state_===ie?c.open(this.deliver,this):c.discardChanges()}else i=a.getValueFrom(o);t?this.value_[r/2]=i:s(i,this.value_[r/2])||(n=n||[],n[r/2]=this.value_[r/2],this.value_[r/2]=i)}return n?(this.report_([this.value_,n,this.observed_]),!0):!1}}),V.prototype={open:function(e,t){return this.callback_=e,this.target_=t,this.value_=this.getValueFn_(this.observable_.open(this.observedCallback_,this)),this.value_},observedCallback_:function(e){if(e=this.getValueFn_(e),!s(e,this.value_)){var t=this.value_;this.value_=e,this.callback_.call(this.target_,this.value_,t)}},discardChanges:function(){return this.value_=this.getValueFn_(this.observable_.discardChanges()),this.value_},deliver:function(){return this.observable_.deliver()},setValue:function(e){return e=this.setValueFn_(e),!this.dontPassThroughSet_&&this.observable_.setValue?this.observable_.setValue(e):void 0},close:function(){this.observable_&&this.observable_.close(),this.callback_=void 0,this.target_=void 0,this.observable_=void 0,this.value_=void 0,this.getValueFn_=void 0,this.setValueFn_=void 0}};var fe={add:!0,update:!0,"delete":!0},pe=0,ve=1,be=2,_e=3;I.prototype={calcEditDistances:function(e,t,n,r,i,o){var s,a,c=o-i+1,u=n-t+1,l=new Array(c);for(s=0;c>s;s++)l[s]=new Array(u),l[s][0]=s;for(a=0;u>a;a++)l[0][a]=a;for(s=1;c>s;s++)for(a=1;u>a;a++)if(this.equals(e[t+a-1],r[i+s-1]))l[s][a]=l[s-1][a-1];else{var d=l[s-1][a]+1,h=l[s][a-1]+1;l[s][a]=h>d?d:h}return l},spliceOperationsFromEditDistances:function(e){for(var t=e.length-1,n=e[0].length-1,r=e[t][n],i=[];t>0||n>0;)if(0!=t)if(0!=n){var o,s=e[t-1][n-1],a=e[t-1][n],c=e[t][n-1];o=c>a?s>a?a:s:s>c?c:s,o==s?(s==r?i.push(pe):(i.push(ve),r=s),t--,n--):o==a?(i.push(_e),t--,r=a):(i.push(be),n--,r=c)}else i.push(_e),t--;else i.push(be),n--;return i.reverse(),i},calcSplices:function(e,t,n,r,i,o){var s=0,a=0,c=Math.min(n-t,o-i);if(0==t&&0==i&&(s=this.sharedPrefix(e,r,c)),n==e.length&&o==r.length&&(a=this.sharedSuffix(e,r,c-s)),t+=s,i+=s,n-=a,o-=a,n-t==0&&o-i==0)return[];var u;if(t==n){for(u=N(t,[],0);o>i;)u.removed.push(r[i++]);return[u]}if(i==o)return[N(t,[],n-t)];for(var l=this.spliceOperationsFromEditDistances(this.calcEditDistances(e,t,n,r,i,o)),d=[],h=t,f=i,p=0;p<l.length;p++)switch(l[p]){case pe:u&&(d.push(u),u=void 0),h++,f++;break;case ve:u||(u=N(h,[],0)),u.addedCount++,h++,u.removed.push(r[f]),f++;break;case be:u||(u=N(h,[],0)),u.addedCount++,h++;break;case _e:u||(u=N(h,[],0)),u.removed.push(r[f]),f++}return u&&d.push(u),d},sharedPrefix:function(e,t,n){for(var r=0;n>r;r++)if(!this.equals(e[r],t[r]))return r;return n},sharedSuffix:function(e,t,n){for(var r=e.length,i=t.length,o=0;n>o&&this.equals(e[--r],t[--i]);)o++;return o},calculateSplices:function(e,t){return this.calcSplices(e,0,e.length,t,0,t.length)},equals:function(e,t){return e===t}};var ge=new I,ye=e;"undefined"==typeof exports||exports.nodeType||("undefined"!=typeof module&&module.exports&&(exports=module.exports),ye=exports),ye.Observer=x,ye.Observer.runEOM_=te,ye.Observer.observerSentinel_=he,ye.Observer.hasObjectObserve=q,ye.ArrayObserver=P,ye.ArrayObserver.calculateSplices=function(e,t){return ge.calculateSplices(e,t)},ye.ArraySplice=I,ye.ObjectObserver=C,ye.PathObserver=k,ye.CompoundObserver=A,ye.Path=d,ye.ObserverTransform=V}("undefined"!=typeof global&&global&&"undefined"!=typeof module&&module?global:this||window),function(e){"use strict";function t(e){for(;e.parentNode;)e=e.parentNode;return"function"==typeof e.getElementById?e:null}function n(e,t,n){var r=e.bindings_;return r||(r=e.bindings_={}),r[t]&&r[t].close(),r[t]=n}function r(e,t,n){return n}function i(e){return null==e?"":e}function o(e,t){e.data=i(t)}function s(e){return function(t){return o(e,t)}}function a(e,t,n,r){return n?void(r?e.setAttribute(t,""):e.removeAttribute(t)):void e.setAttribute(t,i(r))}function c(e,t,n){return function(r){a(e,t,n,r)}}function u(e){switch(e.type){case"checkbox":return O;case"radio":case"select-multiple":case"select-one":return"change";case"range":if(/Trident|MSIE/.test(navigator.userAgent))return"change";default:return"input"}}function l(e,t,n,r){e[t]=(r||i)(n)}function d(e,t,n){return function(r){return l(e,t,r,n)}}function h(){}function f(e,t,n,r){function i(){var i="value"==t&&"number"==e.type;n.setValue(i?e.valueAsNumber:e[t]),n.discardChanges(),(r||h)(e),Platform.performMicrotaskCheckpoint()}var o=u(e);return e.addEventListener(o,i),{close:function(){e.removeEventListener(o,i),n.close()},observable_:n}}function p(e){return Boolean(e)}function v(e){if(e.form)return y(e.form.elements,function(t){return t!=e&&"INPUT"==t.tagName&&"radio"==t.type&&t.name==e.name});var n=t(e);if(!n)return[];var r=n.querySelectorAll('input[type="radio"][name="'+e.name+'"]');return y(r,function(t){return t!=e&&!t.form})}function b(e){"INPUT"===e.tagName&&"radio"===e.type&&v(e).forEach(function(e){var t=e.bindings_.checked;t&&t.observable_.setValue(!1)})}function _(e,t){var n,r,o,s=e.parentNode;s instanceof HTMLSelectElement&&s.bindings_&&s.bindings_.value&&(n=s,r=n.bindings_.value,o=n.value),e.value=i(t),n&&n.value!=o&&(r.observable_.setValue(n.value),r.observable_.discardChanges(),Platform.performMicrotaskCheckpoint())}function g(e){return function(t){_(e,t)}}var y=Array.prototype.filter.call.bind(Array.prototype.filter);Node.prototype.bind=function(e,t){console.error("Unhandled binding to Node: ",this,e,t)},Node.prototype.bindFinished=function(){};var m=r;Object.defineProperty(Platform,"enableBindingsReflection",{get:function(){return m===n},set:function(e){return m=e?n:r,e},configurable:!0}),Text.prototype.bind=function(e,t,n){if("textContent"!==e)return Node.prototype.bind.call(this,e,t,n);if(n)return o(this,t);var r=t;return o(this,r.open(s(this))),m(this,e,r)},Element.prototype.bind=function(e,t,n){var r="?"==e[e.length-1];if(r&&(this.removeAttribute(e),e=e.slice(0,-1)),n)return a(this,e,r,t);var i=t;return a(this,e,r,i.open(c(this,e,r))),m(this,e,i)};var O;!function(){var e=document.createElement("div"),t=e.appendChild(document.createElement("input"));t.setAttribute("type","checkbox");var n,r=0;t.addEventListener("click",function(e){r++,n=n||"click"}),t.addEventListener("change",function(){r++,n=n||"change"});var i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null),t.dispatchEvent(i),O=1==r?"change":n}(),HTMLInputElement.prototype.bind=function(e,t,r){if("value"!==e&&"checked"!==e)return HTMLElement.prototype.bind.call(this,e,t,r);this.removeAttribute(e);var o="checked"==e?p:i,s="checked"==e?b:h;if(r)return l(this,e,t,o);var a=t,c=f(this,e,a,s);return l(this,e,a.open(d(this,e,o)),o),n(this,e,c)},HTMLTextAreaElement.prototype.bind=function(e,t,n){if("value"!==e)return HTMLElement.prototype.bind.call(this,e,t,n);if(this.removeAttribute("value"),n)return l(this,"value",t);var r=t,o=f(this,"value",r);return l(this,"value",r.open(d(this,"value",i))),m(this,e,o)},HTMLOptionElement.prototype.bind=function(e,t,n){if("value"!==e)return HTMLElement.prototype.bind.call(this,e,t,n);if(this.removeAttribute("value"),n)return _(this,t);var r=t,i=f(this,"value",r);return _(this,r.open(g(this))),m(this,e,i)},HTMLSelectElement.prototype.bind=function(e,t,r){if("selectedindex"===e&&(e="selectedIndex"),"selectedIndex"!==e&&"value"!==e)return HTMLElement.prototype.bind.call(this,e,t,r);if(this.removeAttribute(e),r)return l(this,e,t);var i=t,o=f(this,e,i);return l(this,e,i.open(d(this,e))),n(this,e,o)}}(this),function(e,t){"undefined"!=typeof module&&module.exports?module.exports=t(require("elliptical-utils")):"function"==typeof define&&define.amd?define(["elliptical-utils"],t):(e.elliptical=e.elliptical||{},e.elliptical.observable=e.elliptical.observable||{},e.elliptical.observable.report=t(e.elliptical.utils),e.returnExports=e.elliptical.observable.report)}(this,function(e){var t=e.string;return{splitPath:function(e,t){return"undefined"==typeof t&&(t="."),"undefined"==typeof e||""===e?[]:Array.isArray(e)?e.slice(0):e.toString().split(t);
},getObjValueByPath:function(e,t){try{var n=this.splitPath(t),r=e;return n.forEach(function(e){var t=r[e];r=t}),r}catch(i){return void 0}},setObjValueByPath:function(e,t,n){try{for(var r=this.splitPath(t),i=e,o=r.length,s=o-1,a=0;o>a;a++)if(a===s)i[r[a]]=n;else{var c=i[r[a]];i=c}}catch(u){}},bracketPathFormat:function(t){var n=this.splitPath(t),r=e.isNumeric;if(n&&n.length){var i=n.map(function(e){return r(e)?"["+e.toString()+"]":e});return i.join(".").replace(/.\[/,"[")}return t},objChangedProps:function(t,n){var r={},i=this.keys(t);return i.forEach(function(i){e.isEqual(t[i],n[i])||(r[i]=t[i])}),r},isPropertyArray:function(e,t){try{var n=e[Object.keys(e)[t]];return!!Array.isArray(n)}catch(r){return!1}},propertyByIndex:function(e,t){return e[Object.keys(e)[t]]},changeRecord:{get entity(){return{object:void 0,value:void 0,oldValue:void 0,path:void 0,name:void 0,root:void 0}},get result(){return{added:[],changed:[],removed:[]}}},keys:function(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(n);return t},isArrayList:function(e){if(Array.isArray(e))return e;var t=this.keys(e).length;if(t>1)return null;var n=e[Object.keys(e)[0]];return Array.isArray(n)?n:null},pathReplace:function(e){var n=e.replace(/\//g,".");return"."===t.firstChar(n)&&(n=t.trimFirstChar(n)),n},objDiffReport:function(e,t){var n,r=this.changeRecord.result,i=this,o=this.isArrayList(e);return t&&t.length&&t.forEach(function(e){if(o){if(e.addedCount&&e.addedCount>0&&"splice"===e.type&&r.added.push(e.object[e.index]),e.removed&&e.removed.length>0&&"splice"===e.type&&(r.removed=r.removed.concat(e.removed)),"update"===e.type){n=i.pathReplace(e.path);var t={object:e.object,value:e.value,oldValue:e.oldValue,path:n,name:e.name,root:e.root};r.changed.push(t)}}else{n=i.pathReplace(e.path);var s={object:e.object,value:e.object[e.name],oldValue:e.oldValue,path:n,name:e.name,root:e.root};r.changed.push(s)}}),r}}}),function(e,t){"undefined"!=typeof module&&module.exports?module.exports=t(require("observe-js"),require("nested-observe"),require("./report")):"function"==typeof define&&define.amd?define(["observe-js","nested-observe","./report"],t):e.returnExports=t(e,e.Nested,e.elliptical.observable)}(this,function(e,t,n){function r(){function e(e){t=e}if("function"!=typeof Object.observe||"function"!=typeof Array.observe)return!1;var t=[],n={},r=[];return Object.observe(n,e),Array.observe(r,e),n.id=1,n.id=2,delete n.id,r.push(1,2),r.length=0,Object.deliverChangeRecords(e),5!==t.length?!1:"add"!=t[0].type||"update"!=t[1].type||"delete"!=t[2].type||"splice"!=t[3].type||"splice"!=t[4].type?!1:(Object.unobserve(n,e),Array.unobserve(r,e),!0)}function i(e,t){var n,r={},i={},o={};for(n in t){var s=e[n];(void 0===s||s!==t[n])&&(n in e?s!==t[n]&&(o[n]=s):i[n]=void 0)}for(n in e)n in t||(r[n]=e[n]);return Array.isArray(e)&&e.length!==t.length&&(o.length=e.length),{added:r,removed:i,changed:o}}function o(e,t,n){var r=d.pop()||s();return r.open(e),r.observe(t,n),r}function s(){function e(e){t&&t.state_===l&&!r&&t.check_(e)}var t,n,r=!1,i=!0;return{open:function(n){if(t)throw Error("ObservedObject in use");i||Object.deliverChangeRecords(e),t=n,i=!1},observe:function(t,r){n=t,r?Array.observe(n,e):Object.observe(n,e)},deliver:function(t){r=t,Object.deliverChangeRecords(e),r=!1},close:function(){t=void 0,Object.unobserve(n,e),d.push(this)}}}function a(e,t,n){for(var r={},i={},o=0;o<t.length;o++){var s=t[o];h[s.type]?(s.name in n||(n[s.name]=s.oldValue),"update"!=s.type&&("add"!=s.type?s.name in r?(delete r[s.name],delete n[s.name]):i[s.name]=!0:s.name in i?delete i[s.name]:r[s.name]=!0)):(console.error("Unknown changeRecord type: "+s.type),console.error(s))}for(var a in r)r[a]=e[a];for(var a in i)i[a]=void 0;var c={};for(var a in n)if(!(a in r||a in i)){var u=e[a];n[a]!==u&&(c[a]=u)}return{added:r,removed:i,changed:c}}var c=n.report,u=r(),l=1,d=[],h={add:!0,update:!0,"delete":!0},f=ObjectObserver.prototype;return ObjectObserver=function(e,t){Observer.call(this),this.value_=e,this.oldObject_=void 0,this._override=t},ObjectObserver.prototype=f,ObjectObserver.prototype.connect_=function(){void 0!==this._override?t.observe(this.value_,this.check_.bind(this)):u?this.directObserver_=o(this,this.value_,this.arrayObserve):this.oldObject_=this.copyObject(this.value_)},ObjectObserver.prototype.check_=function(e,t){if(void 0!==this._override){var n;return e?(n=c.objDiffReport(this.value_,e),this.callback_.call(this,n),!0):!1}var r,o;if(u){if(!e)return!1;o={},r=a(this.value_,e,o)}else o=this.oldObject_,r=i(this.value_,this.oldObject_);return diffIsEmpty(r)?!1:(u||(this.oldObject_=this.copyObject(this.value_)),this.report_([r.added||{},r.removed||{},r.changed||{},function(e){return o[e]}]),!0)},ObjectObserver.prototype.disconnect_=function(){void 0!==this._override?t.unobserve(this.value_,function(){}):u?(this.directObserver_.close(),this.directObserver_=void 0):this.oldObject_=void 0},e.ObjectObserver=ObjectObserver,e}),function(e,t){"undefined"!=typeof module&&module.exports?module.exports=t():"function"==typeof define&&define.amd?define([],t):(e.elliptical=e.elliptical||{},e.elliptical.observable=e.elliptical.observable||{},e.elliptical.observable.cache=t(),e.returnExports=e.elliptical.observable.cache)}(this,function(){return{_initCache:function(){var e=this.$cache();this._data.set("$cache",e)},$cache:function(){var e={},t=1;return{reset:function(){t=1,e={}},set:function(n,r){n.__data||(n.__data=t++),e[n.__data]=r},get:function(t){return e[t.__data]}}},_disposeCache:function(){var e=this._data.get("$cache");e=null},_dispose:function(){this._disposeCache(),this._super&&this._super()}}}),function(e,t){"undefined"!=typeof module&&module.exports?module.exports=t(require("elliptical-event")):"function"==typeof define&&define.amd?define(["elliptical-event"],t):(e.elliptical.observable=e.elliptical.observable||{},e.elliptical.observable.pubsub=t(e.elliptical.Event),e.returnExports=e.elliptical.observable.pubsub)}(this,function(e){return{_publish:function(t,n){e.emit(t,n)},_subscribe:function(t,n){var r=this._data.get("subscriptions");r||(r=new Map),r.set(t,n),this._data.set("subscriptions",r),e.on(t,n)},_subscriptions:$.noop,_unbindSubscriptions:function(){var t=this._data.get("subscriptions");t.forEach(function(t,n){e.off(n,t)})},_disposePubSub:function(){this._unbindSubscriptions()},_dispose:function(){this._disposePubSub(),this._super&&this._super()}}}),function(e,t){"undefined"!=typeof module&&module.exports?module.exports=t(require("elliptical-utils"),require("./report")):"function"==typeof define&&define.amd?define(["elliptical-utils","./report"],t):(e.elliptical.observable=e.elliptical.observable||{},e.elliptical.observable.scope=t(e.elliptical.utils,e.elliptical.observable.report),e.returnExports=e.elliptical.observable.scope)}(this,function(e,t){var n=e.object;return{_initScopeElement:function(){var e=this.options?this.options.scopeBind:this.scopeBind,t=this.options?this.options.idProp:this.idProp;void 0===e&&(e=!0),this._data.set("scopeTimeoutId",null),this._data.set("scopeObserver",null),this._data.set("scopeId",t),this.__initScope(),this.__bindByDataAttribute()?this._setObservable():e&&this.__initScopeObservable()},__initScope:function(){var e=this;this.$scope={};var t=this.element[0];Object.defineProperty(t,"$scope",{get:function(){return e.$scope},set:function(t){e.$scope=t},enumerable:!0,configurable:!0})},__initScopeObservable:function(){var e=this,t=5,r=0,i=setInterval(function(){e._data.set("scopeTimeoutId",i);var o=n.isEmpty(e.$scope);o?t>=r?r++:clearInterval(i):(clearInterval(i),e._setObservable())},300)},__bindByDataAttribute:function(){var e=this.options?this.options.data:this.data;if(void 0===e)return!1;e=JSON.parse(e);var t=this.options?this.options.scope:this.scope;return t?this.$scope[t]=e:this.$scope=e,!0},_setObservable:function(){if(!this._data.get("scopeObserver")){var e=this.$scope,t=this,n=new ObjectObserver(e,!0);n.open(function(e){t.__onScopeChange(e)}),this._data.set("scopeObserver",n)}},__destroyObservable:function(){var e=this._data.get("scopeObserver");e&&(e.disconnect_(),e=null,this.$scope=null)},__resetObservable:function(){this.__destroyObservable(),this._setObservable()},__scopeLength:function(e){var n="undefined"==typeof e?this.$scope:e;if(t.isPropertyArray(n,0)){var r=t.propertyByIndex(n,0);return r.length}return-1},__recycle:function(){this.__destroyObservable(),this._setObservable()},__onScopeChange:function(e){this._onScopeChange(e)},_objectChange:function(e){if(void 0!==e){if(e.object&&e.oldObject)return t.objChangedProps(e.object,e.oldObject);var n={};return n[e.name]=e.value,n}},_disposeScope:function(){this.__destroyObservable()},_dispose:function(){this._disposeScope(),this._super&&this._super()},_onScopeChange:function(){},_onScopeBind:function(){},_scopeSetter:function(e,t,n){var r=this.options?this.options.scopeSetterDelay:this.scopeSetterDelay;void 0===r&&(r=300);var i=void 0!==window.__observePolyfill,o=this.$scope;"undefined"==typeof n?i?setTimeout(function(){o[e]=t},r):o[e]=t:i?setTimeout(function(){o[n][e]=t},r):o[n][e]=t},_changeReport:function(e,n){return t.objChangedProps(e,n)},$setScope:function(e){void 0!==e&&(this.$scope=e),this._setObservable(),this._onScopeBind()}}}),function(e,t){"undefined"!=typeof module&&module.exports?module.exports=t():"function"==typeof define&&define.amd?define([],t):(e.elliptical.observable=e.elliptical.observable||{},e.elliptical.observable.template=t(e.elliptical.utils,e.elliptical.observable.report),e.returnExports=e.elliptical.observable.template)}(this,function(e,t){var n=8,r=500,i=e.random,o=e.object,s=e.string;return{_initTemplateElement:function(){var e=this.options?this.options.scopeBind:this.scopeBind;void 0===e&&(e=!0),e&&this._watch(),this._setAutoRebind(),this._initPathObservers(),this._data.set("templateId",null),this._data.set("templateNode",null)},_setAutoRebind:function(){var e=this.options?this.options.autoRebind:this.autoRebind;void 0===e&&(e=!0),this._data.set("autoRebind",e)},_initPathObservers:function(){this._data.set("pathObservers",[])},_watch:function(){var e=0,t=this,i=setInterval(function(){if(t.__isReady()){var r=t._getTemplateId();if(r)t._data.set("templateId",r),clearInterval(i),t.__render();else{var o=t._getTemplateNode();o?(clearInterval(i),t._data.set("templateNode",o),r=t._setTemplateId(o),t._precompileTemplate(o,r),t.__render()):(e>n&&clearInterval(i),e++)}}else e>n&&clearInterval(i),e++},r)},__isReady:function(){return o.isEmpty(this.$scope)?!1:this._isReady()},_isReady:function(){return!0},_getTemplateId:function(){var e=this._getTemplateNode();if(e){var t=e.getAttribute("template");return""===t?null:t}return null},_getTemplateNode:function(){var e=this.element,t=e.selfFind("[template]");return t[0]?t[0]:null},_setTemplateId:function(e){var t="tmpl-"+i.str(6);return e.setAttribute("template",t),this._data.set("templateId",t),t},_setVisibility:function(){var e=this._data.get("templateNode");e&&e.classList.add("visible")},_connectDOMObserver:function(){var e=this._data.get("templateNode");$(e).mutationSummary("connect",this.__onMutation.bind(this),[{all:!0}])},__onMutation:function(e){e.added&&this._onMutationAdded(e.added),e.removed&&this._onMutationRemoved(e.removed)},_onMutationAdded:function(e){},_onMutationRemoved:function(e){},__render:function(){var e=this,t=this.options?this.options.twoWayBind:this.twoWayBind;void 0===t&&(t=!0);var n=this._data.get("templateNode"),r=this._data.get("templateId");this._render(n,r,this.$scope,function(r,i){t&&e.__dataBind(n),e._setVisibility(),e._connectDOMObserver()})},__dataBind:function(n){var r=this._data.get("pathObservers"),i=this,s=function(e){3!==e.nodeType&&e.hasAttributes&&e.hasAttributes()&&a(e)},a=function(e){$.each(e.attributes,function(t,n){if(n&&"data-bind"===n.name&&void 0!==n.value&&""!==n.value){var r=n.value.trim(),i=r.split(":"),o=i[0];"text"===o?c(e,i):u(e,i)}})},c=function(n,s){var a={};s.length>2&&(a=l(s[2]));var c=s[1],u=t.getObjValueByPath(i.$scope,c);o.isEmpty(a)||(u=d(u,a),e.setObjValueByPath(i.$scope,c,u));var h=i.__createTextNode(n,u);c=t.bracketPathFormat(c);var f=new PathObserver(i.$scope,c);h.bind("textContent",f),r.push(f)},u=function(n,s){var a={},c=s[0];s.length>2&&(a=l(s[2]));var u=s[1],h=t.getObjValueByPath(i.$scope,u);o.isEmpty(a)||(h=d(h,a),e.setObjValueByPath(i.$scope,u,h)),u=t.bracketPathFormat(u);var f=new PathObserver(i.$scope,u);n.bind(c,f),r.push(f)},l=function(e){var t,n=e.match(/\((.*?)\)/g);n||(n="");var r=e.replace(n,"");return n=n.replace("(",""),n=n.replace(")",""),t=n.length<1?[]:n.split(","),{func:r,args:t}},d=function(e,t){var n,r,o=t.func;return window.dust.helpers.inline[o]?(n=window.dust.helpers.inline[o],r=t.args,r.length>0?r.unshift(e):r.push(e),n.apply(this,r)):window[o]?(n=window[o],r=t.args,r.length>0?r.unshift(e):r.push(e),n.apply(this,r)):i[o]?(n=i[o],r=t.args,r.length>0?r.unshift(e):r.push(e),n.apply(i,r)):e};this._traverseDOM(n,s)},_traverseDOM:function(e,t){for(t(e),e=e.firstChild;e;)this._traverseDOM(e,t),e=e.nextSibling},__createTextNode:function(e,t){var n=$(e),r=n.text();r=r?r.replace(t,""):t,n.text(r);var i=document.createTextNode(t);return e.appendChild(i),i},__onScopeChange:function(e){if(this._passScopeFilter(e)){var t=this._data.get("autoRebind");t&&(e.removed&&e.removed.length&&e.removed.length>0?this._rebind():e.added&&e.added.length&&e.added.length>0&&this._rebind()),this._onScopeChange(e)}},_passScopeFilter:function(e){return e.changed.length>0?this._filterScopeChange(e.changed):e.added.length>0?this._filterScopeChange(e.added):e.removed.length>0?this._filterScopeChange(e.removed):void 0},_filterScopeChange:function(e){var t=!1;return e.forEach(function(e){"$"!==s.firstChar(e.name)&&(t=!0)}),t},_rebind:function(){this._disposeTemplate(),this._initPathObservers(),this.__render()},_disconnectDOMObserver:function(){var e=this._data.get("templateNode");$(e).mutationSummary("disconnect")},_disconnectPathObservers:function(){var e=this._data.get("pathObservers");e.forEach(function(e){e.disconnect_()}),e=null},_disposeTemplate:function(){this._disconnectDOMObserver(),this._disconnectPathObservers()},_dispose:function(){this._disposeTemplate(),this._super&&this._super()},$rebind:function(){this._rebind()}}});