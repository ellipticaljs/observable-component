!function(t,e){"function"==typeof define&&define.amd&&define.amd.dust===!0?define("dust.core",[],e):"object"==typeof exports?module.exports=e():t.dust=e()}(this,function(){function getTemplate(t,e){return t?"function"==typeof t&&t.template?t.template:dust.isTemplateFn(t)?t:e!==!1?dust.cache[t]:void 0:void 0}function load(t,e,r){if(!t)return e.setError(new Error("No template or template name provided to render"));var n=getTemplate(t,dust.config.cache);return n?n(e,Context.wrap(r,n.templateName)):dust.onLoad?e.map(function(e){function n(t,n){var i;if(t)return e.setError(t);if(i=getTemplate(n,!1)||getTemplate(o,dust.config.cache),!i){if(!dust.compile)return e.setError(new Error("Dust compiler not available"));i=dust.loadSource(dust.compile(n,o))}i(e,Context.wrap(r,i.templateName)).end()}var o=t;3===dust.onLoad.length?dust.onLoad(o,r.options,n):dust.onLoad(o,n)}):e.setError(new Error("Template Not Found: "+t))}function Context(t,e,r,n,o){void 0===t||t instanceof Stack||(t=new Stack(t)),this.stack=t,this.global=e,this.options=r,this.blocks=n,this.templateName=o}function getWithResolvedData(t,e,r){return function(n){return t.push(n)._get(e,r)}}function Stack(t,e,r,n){this.tail=e,this.isObject=t&&"object"==typeof t,this.head=t,this.index=r,this.of=n}function Stub(t){this.head=new Chunk(this),this.callback=t,this.out=""}function Stream(){this.head=new Chunk(this)}function StackIndex(t){this.stack=t,this.index=null}function Chunk(t,e,r){this.root=t,this.next=e,this.data=[],this.flushable=!1,this.taps=r}function Tap(t,e){this.head=t,this.tail=e}var dust={version:"2.7.2"},NONE="NONE",ERROR="ERROR",WARN="WARN",INFO="INFO",DEBUG="DEBUG",EMPTY_FUNC=function(){};dust.config={whitespace:!1,amd:!1,cjs:!1,cache:!0},dust._aliases={write:"w",end:"e",map:"m",render:"r",reference:"f",section:"s",exists:"x",notexists:"nx",block:"b",partial:"p",helper:"h"},function(){var t,e,r={DEBUG:0,INFO:1,WARN:2,ERROR:3,NONE:4};"undefined"!=typeof console&&console.log?(t=console.log,e="function"==typeof t?function(){t.apply(console,arguments)}:function(){t(Array.prototype.slice.apply(arguments).join(" "))}):e=EMPTY_FUNC,dust.log=function(t,n){n=n||INFO,r[n]>=r[dust.debugLevel]&&(e("[DUST:"+n+"]",t),n===ERROR&&dust.debugLevel===DEBUG&&t instanceof Error&&t.stack&&e("[DUST:"+n+"]",t.stack))},dust.debugLevel=NONE,"undefined"!=typeof process&&process.env&&/\bdust\b/.test(process.env.DEBUG)&&(dust.debugLevel=DEBUG)}(),dust.helpers={},dust.cache={},dust.register=function(t,e){t&&(e.templateName=t,dust.config.cache!==!1&&(dust.cache[t]=e))},dust.render=function(t,e,r){var n=new Stub(r).head;try{load(t,n,e).end()}catch(o){n.setError(o)}},dust.stream=function(t,e){var r=new Stream,n=r.head;return dust.nextTick(function(){try{load(t,n,e).end()}catch(r){n.setError(r)}}),r},dust.loadSource=function(source){return eval(source)},Array.isArray?dust.isArray=Array.isArray:dust.isArray=function(t){return"[object Array]"===Object.prototype.toString.call(t)},dust.nextTick=function(){return function(t){setTimeout(t,0)}}(),dust.isEmpty=function(t){return 0===t?!1:dust.isArray(t)&&!t.length?!0:!t},dust.isEmptyObject=function(t){var e;if(null===t)return!1;if(void 0===t)return!1;if(t.length>0)return!1;for(e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0},dust.isTemplateFn=function(t){return"function"==typeof t&&t.__dustBody},dust.isThenable=function(t){return t&&"object"==typeof t&&"function"==typeof t.then},dust.isStreamable=function(t){return t&&"function"==typeof t.on&&"function"==typeof t.pipe},dust.filter=function(t,e,r,n){var o,i,u,s;if(r)for(o=0,i=r.length;i>o;o++)u=r[o],u.length&&(s=dust.filters[u],"s"===u?e=null:"function"==typeof s?t=s(t,n):dust.log("Invalid filter `"+u+"`",WARN));return e&&(t=dust.filters[e](t,n)),t},dust.filters={h:function(t){return dust.escapeHtml(t)},j:function(t){return dust.escapeJs(t)},u:encodeURI,uc:encodeURIComponent,js:function(t){return dust.escapeJSON(t)},jp:function(t){return JSON?JSON.parse(t):(dust.log("JSON is undefined; could not parse `"+t+"`",WARN),t)}},dust.makeBase=dust.context=function(t,e){return new Context(void 0,t,e)},Context.wrap=function(t,e){return t instanceof Context?(t.templateName=e,t):new Context(t,{},{},null,e)},Context.prototype.get=function(t,e){return"string"==typeof t&&("."===t[0]&&(e=!0,t=t.substr(1)),t=t.split(".")),this._get(e,t)},Context.prototype._get=function(t,e){var r,n,o,i,u,s=this.stack||{},c=1;if(n=e[0],o=e.length,t&&0===o)i=s,s=s.head;else{if(t)s&&(s=s.head?s.head[n]:void 0);else{for(;s&&(!s.isObject||(i=s.head,r=s.head[n],void 0===r));)s=s.tail;s=void 0!==r?r:this.global&&this.global[n]}for(;s&&o>c;){if(dust.isThenable(s))return s.then(getWithResolvedData(this,t,e.slice(c)));i=s,s=s[e[c]],c++}}return"function"==typeof s?(u=function(){try{return s.apply(i,arguments)}catch(t){throw dust.log(t,ERROR),t}},u.__dustBody=!!s.__dustBody,u):(void 0===s&&dust.log("Cannot find reference `{"+e.join(".")+"}` in template `"+this.getTemplateName()+"`",INFO),s)},Context.prototype.getPath=function(t,e){return this._get(t,e)},Context.prototype.push=function(t,e,r){return void 0===t?(dust.log("Not pushing an undefined variable onto the context",INFO),this):this.rebase(new Stack(t,this.stack,e,r))},Context.prototype.pop=function(){var t=this.current();return this.stack=this.stack&&this.stack.tail,t},Context.prototype.rebase=function(t){return new Context(t,this.global,this.options,this.blocks,this.getTemplateName())},Context.prototype.clone=function(){var t=this.rebase();return t.stack=this.stack,t},Context.prototype.current=function(){return this.stack&&this.stack.head},Context.prototype.getBlock=function(t){var e,r,n;if("function"==typeof t&&(t=t(new Chunk,this).data.join("")),e=this.blocks,!e)return dust.log("No blocks for context `"+t+"` in template `"+this.getTemplateName()+"`",DEBUG),!1;for(r=e.length;r--;)if(n=e[r][t])return n;return dust.log("Malformed template `"+this.getTemplateName()+"` was missing one or more blocks."),!1},Context.prototype.shiftBlocks=function(t){var e,r=this.blocks;return t?(e=r?r.concat([t]):[t],new Context(this.stack,this.global,this.options,e,this.getTemplateName())):this},Context.prototype.resolve=function(t){var e;return"function"!=typeof t?t:(e=(new Chunk).render(t,this),e instanceof Chunk?e.data.join(""):e)},Context.prototype.getTemplateName=function(){return this.templateName},Stub.prototype.flush=function(){for(var t=this.head;t;){if(!t.flushable)return t.error?(this.callback(t.error),dust.log("Rendering failed with error `"+t.error+"`",ERROR),void(this.flush=EMPTY_FUNC)):void 0;this.out+=t.data.join(""),t=t.next,this.head=t}this.callback(null,this.out)},Stream.prototype.flush=function(){for(var t=this.head;t;){if(!t.flushable)return t.error?(this.emit("error",t.error),this.emit("end"),dust.log("Streaming failed with error `"+t.error+"`",ERROR),void(this.flush=EMPTY_FUNC)):void 0;this.emit("data",t.data.join("")),t=t.next,this.head=t}this.emit("end")},Stream.prototype.emit=function(t,e){var r,n,o=this.events||{},i=o[t]||[];if(!i.length)return dust.log("Stream broadcasting, but no listeners for `"+t+"`",DEBUG),!1;for(i=i.slice(0),r=0,n=i.length;n>r;r++)i[r](e);return!0},Stream.prototype.on=function(t,e){var r=this.events=this.events||{},n=r[t]=r[t]||[];return"function"!=typeof e?dust.log("No callback function provided for `"+t+"` event listener",WARN):n.push(e),this},Stream.prototype.pipe=function(t){if("function"!=typeof t.write||"function"!=typeof t.end)return dust.log("Incompatible stream passed to `pipe`",WARN),this;var e=!1;return"function"==typeof t.emit&&t.emit("pipe",this),"function"==typeof t.on&&t.on("error",function(){e=!0}),this.on("data",function(r){if(!e)try{t.write(r,"utf8")}catch(n){dust.log(n,ERROR)}}).on("end",function(){if(!e)try{t.end(),e=!0}catch(r){dust.log(r,ERROR)}})},StackIndex.prototype.indices=function(){var t=this.stack,e=[],r=function(t){for(var n in t)if(t.hasOwnProperty(n)&&"tail"===n&&"object"==typeof t[n]){var o=t[n],i=o.index;void 0!==i&&(e.push(i),r(o))}};if(void 0!==t.index){e.push(t.index),r(t);var n=e.length;e=e.reverse();for(var o=[],i=0;n>i;i++){var u={index:"$"+i.toString(),value:e[i]};o.push(u)}return this.index="$"+n.toString(),o}return null},Chunk.prototype.write=function(t){var e=this.taps;return e&&(t=e.go(t)),this.data.push(t),this},Chunk.prototype.end=function(t){return t&&this.write(t),this.flushable=!0,this.root.flush(),this},Chunk.prototype.map=function(t){var e=new Chunk(this.root,this.next,this.taps),r=new Chunk(this.root,e,this.taps);this.next=r,this.flushable=!0;try{t(r)}catch(n){dust.log(n,ERROR),r.setError(n)}return e},Chunk.prototype.tap=function(t){var e=this.taps;return e?this.taps=e.push(t):this.taps=new Tap(t),this},Chunk.prototype.untap=function(){return this.taps=this.taps.tail,this},Chunk.prototype.render=function(t,e){return t(this,e)},Chunk.prototype.reference=function(t,e,r,n){return"function"==typeof t?(t=t.apply(e.current(),[this,e,null,{auto:r,filters:n}]),t instanceof Chunk?t:this.reference(t,e,r,n)):dust.isThenable(t)?this.await(t,e,null,r,n):dust.isStreamable(t)?this.stream(t,e,null,r,n):dust.isEmpty(t)?this:this.write(dust.filter(t,r,n,e))},Chunk.prototype.section=function(t,e,r,n){var o,i,u,s=r.block,c=r["else"],a=this;if("function"==typeof t&&!dust.isTemplateFn(t)){try{t=t.apply(e.current(),[this,e,r,n])}catch(l){return dust.log(l,ERROR),this.setError(l)}if(t instanceof Chunk)return t}if(dust.isEmptyObject(r))return a;if(dust.isEmptyObject(n)||(e=e.push(n)),dust.isArray(t)){if(s){if(i=t.length,i>0){u=e.stack&&e.stack.head||{},u.$len=i;var f=new StackIndex(e.stack),p=f.indices(),d=f.index;if(p)for(var h=0;h<p.length;h++)u[p[h].index]=p[h].value;for(o=0;i>o;o++)u.$idx=o,d?u[d]=o:u.$0=o,a=s(a,e.push(t[o],o,i));return delete u.$idx,delete u.$len,d?(delete u[d],p&&p.forEach(function(t){delete u[t.index]})):void 0!==u.$0&&delete u.$0,a}if(c)return c(this,e)}}else{if(dust.isThenable(t))return this.await(t,e,r);if(dust.isStreamable(t))return this.stream(t,e,r);if(t===!0){if(s)return s(this,e)}else if(t||0===t){if(s)return s(this,e.push(t))}else if(c)return c(this,e)}return dust.log("Section without corresponding key in template `"+e.getTemplateName()+"`",DEBUG),this},Chunk.prototype.exists=function(t,e,r){var n=r.block,o=r["else"];if(dust.isEmpty(t)){if(o)return o(this,e)}else{if(n)return n(this,e);dust.log("No block for exists check in template `"+e.getTemplateName()+"`",DEBUG)}return this},Chunk.prototype.notexists=function(t,e,r){var n=r.block,o=r["else"];if(dust.isEmpty(t)){if(n)return n(this,e);dust.log("No block for not-exists check in template `"+e.getTemplateName()+"`",DEBUG)}else if(o)return o(this,e);return this},Chunk.prototype.block=function(t,e,r){var n=t||r.block;return n?n(this,e):this},Chunk.prototype.partial=function(t,e,r,n){var o;return void 0===n&&(n=r,r=e),dust.isEmptyObject(n)||(r=r.clone(),o=r.pop(),r=r.push(n).push(o)),dust.isTemplateFn(t)?this.capture(t,e,function(t,e){load(t,e,r).end()}):load(t,this,r)},Chunk.prototype.helper=function(t,e,r,n,o){var i,u=this,s=n.filters;if(void 0===o&&(o="h"),!dust.helpers[t])return dust.log("Helper `"+t+"` does not exist",WARN),u;try{return i=dust.helpers[t](u,e,r,n),i instanceof Chunk?i:("string"==typeof s&&(s=s.split("|")),dust.isEmptyObject(r)?u.reference(i,e,o,s):u.section(i,e,r,n))}catch(c){return dust.log("Error in helper `"+t+"`: "+c.message,ERROR),u.setError(c)}},Chunk.prototype.await=function(t,e,r,n,o){return this.map(function(i){t.then(function(t){i=r?i.section(t,e,r):i.reference(t,e,n,o),i.end()},function(t){var n=r&&r.error;n?i.render(n,e.push(t)).end():(dust.log("Unhandled promise rejection in `"+e.getTemplateName()+"`",INFO),i.end())})})},Chunk.prototype.stream=function(t,e,r,n,o){var i=r&&r.block,u=r&&r.error;return this.map(function(s){var c=!1;t.on("data",function(t){c||(i?s=s.map(function(r){r.render(i,e.push(t)).end()}):r||(s=s.reference(t,e,n,o)))}).on("error",function(t){c||(u?s.render(u,e.push(t)):dust.log("Unhandled stream error in `"+e.getTemplateName()+"`",INFO),c||(c=!0,s.end()))}).on("end",function(){c||(c=!0,s.end())})})},Chunk.prototype.capture=function(t,e,r){return this.map(function(n){var o=new Stub(function(t,e){t?n.setError(t):r(e,n)});t(o.head,e).end()})},Chunk.prototype.setError=function(t){return this.error=t,this.root.flush(),this};for(var f in Chunk.prototype)dust._aliases[f]&&(Chunk.prototype[dust._aliases[f]]=Chunk.prototype[f]);Tap.prototype.push=function(t){return new Tap(t,this)},Tap.prototype.go=function(t){for(var e=this;e;)t=e.head(t),e=e.tail;return t};var HCHARS=/[&<>"']/,AMP=/&/g,LT=/</g,GT=/>/g,QUOT=/\"/g,SQUOT=/\'/g;dust.escapeHtml=function(t){return"string"==typeof t||t&&"function"==typeof t.toString?("string"!=typeof t&&(t=t.toString()),HCHARS.test(t)?t.replace(AMP,"&amp;").replace(LT,"&lt;").replace(GT,"&gt;").replace(QUOT,"&quot;").replace(SQUOT,"&#39;"):t):t};var BS=/\\/g,FS=/\//g,CR=/\r/g,LS=/\u2028/g,PS=/\u2029/g,NL=/\n/g,LF=/\f/g,SQ=/'/g,DQ=/"/g,TB=/\t/g;return dust.escapeJs=function(t){return"string"==typeof t?t.replace(BS,"\\\\").replace(FS,"\\/").replace(DQ,'\\"').replace(SQ,"\\'").replace(CR,"\\r").replace(LS,"\\u2028").replace(PS,"\\u2029").replace(NL,"\\n").replace(LF,"\\f").replace(TB,"\\t"):t},dust.escapeJSON=function(t){return JSON?JSON.stringify(t).replace(LS,"\\u2028").replace(PS,"\\u2029").replace(LT,"\\u003c"):(dust.log("JSON is undefined; could not escape `"+t+"`",WARN),t)},dust}),function(t,e){"function"==typeof define&&define.amd&&define.amd.dust===!0?define("dust.parse",["dust.core"],function(t){return e(t).parse}):"object"==typeof exports?module.exports=e(require("./dust")):e(t.dust)}(this,function(t){var e=function(){"use strict";function t(t,e){function r(){this.constructor=t}r.prototype=e.prototype,t.prototype=new r}function e(t,r,n,o){this.message=t,this.expected=r,this.found=n,this.location=o,this.name="SyntaxError","function"==typeof Error.captureStackTrace&&Error.captureStackTrace(this,e)}function r(t){function r(){return i(br,gr)}function n(e){throw s(e,null,t.substring(br,gr),i(br,gr))}function o(e){var r,n,o=xr[e];if(o)return o;for(r=e-1;!xr[r];)r--;for(o=xr[r],o={line:o.line,column:o.column,seenCR:o.seenCR};e>r;)n=t.charAt(r),"\n"===n?(o.seenCR||o.line++,o.column=1,o.seenCR=!1):"\r"===n||"\u2028"===n||"\u2029"===n?(o.line++,o.column=1,o.seenCR=!0):(o.column++,o.seenCR=!1),r++;return xr[e]=o,o}function i(t,e){var r=o(t),n=o(e);return{start:{offset:t,line:r.line,column:r.column},end:{offset:e,line:n.line,column:n.column}}}function u(t){kr>gr||(gr>kr&&(kr=gr,Cr=[]),Cr.push(t))}function s(t,r,n,o){function i(t){var e=1;for(t.sort(function(t,e){return t.description<e.description?-1:t.description>e.description?1:0});e<t.length;)t[e-1]===t[e]?t.splice(e,1):e++}function u(t,e){function r(t){function e(t){return t.charCodeAt(0).toString(16).toUpperCase()}return t.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\x08/g,"\\b").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\f/g,"\\f").replace(/\r/g,"\\r").replace(/[\x00-\x07\x0B\x0E\x0F]/g,function(t){return"\\x0"+e(t)}).replace(/[\x10-\x1F\x80-\xFF]/g,function(t){return"\\x"+e(t)}).replace(/[\u0100-\u0FFF]/g,function(t){return"\\u0"+e(t)}).replace(/[\u1000-\uFFFF]/g,function(t){return"\\u"+e(t)})}var n,o,i,u=new Array(t.length);for(i=0;i<t.length;i++)u[i]=t[i].description;return n=t.length>1?u.slice(0,-1).join(", ")+" or "+u[t.length-1]:u[0],o=e?'"'+r(e)+'"':"end of input","Expected "+n+" but "+o+" found."}return null!==r&&i(r),new e(null!==t?t:u(r,n),r,n,o)}function c(){var t;return t=a()}function a(){var t,e,r;for(t=gr,e=[],r=l();r!==q;)e.push(r),r=l();return e!==q&&(br=t,e=V(e)),t=e}function l(){var t;return t=L(),t===q&&(t=D(),t===q&&(t=f(),t===q&&(t=g(),t===q&&(t=x(),t===q&&(t=y(),t===q&&(t=_())))))),t}function f(){var e,r,n,o,i,s,c,l;if(Nr++,e=gr,r=p(),r!==q){for(n=[],o=z();o!==q;)n.push(o),o=z();n!==q?(o=G(),o!==q?(i=a(),i!==q?(s=v(),s!==q?(c=d(),c===q&&(c=null),c!==q?(br=gr,l=tt(r,i,s,c),l=l?void 0:q,l!==q?(br=e,r=et(r,i,s,c),e=r):(gr=e,e=q)):(gr=e,e=q)):(gr=e,e=q)):(gr=e,e=q)):(gr=e,e=q)):(gr=e,e=q)}else gr=e,e=q;if(e===q)if(e=gr,r=p(),r!==q){for(n=[],o=z();o!==q;)n.push(o),o=z();n!==q?(47===t.charCodeAt(gr)?(o=rt,gr++):(o=q,0===Nr&&u(nt)),o!==q?(i=G(),i!==q?(br=e,r=ot(r),e=r):(gr=e,e=q)):(gr=e,e=q)):(gr=e,e=q)}else gr=e,e=q;return Nr--,e===q&&(r=q,0===Nr&&u(X)),e}function p(){var e,r,n,o,i,s,c;if(e=gr,r=$(),r!==q)if(it.test(t.charAt(gr))?(n=t.charAt(gr),gr++):(n=q,0===Nr&&u(ut)),n!==q){for(o=[],i=z();i!==q;)o.push(i),i=z();o!==q?(i=k(),i!==q?(s=h(),s!==q?(c=m(),c!==q?(br=e,r=st(n,i,s,c),e=r):(gr=e,e=q)):(gr=e,e=q)):(gr=e,e=q)):(gr=e,e=q)}else gr=e,e=q;else gr=e,e=q;return e}function d(){var e,r,n,o,i,s,c;if(Nr++,e=gr,r=$(),r!==q)if(47===t.charCodeAt(gr)?(n=rt,gr++):(n=q,0===Nr&&u(nt)),n!==q){for(o=[],i=z();i!==q;)o.push(i),i=z();if(o!==q)if(i=k(),i!==q){for(s=[],c=z();c!==q;)s.push(c),c=z();s!==q?(c=G(),c!==q?(br=e,r=at(i),e=r):(gr=e,e=q)):(gr=e,e=q)}else gr=e,e=q;else gr=e,e=q}else gr=e,e=q;else gr=e,e=q;return Nr--,e===q&&(r=q,0===Nr&&u(ct)),e}function h(){var e,r,n,o;return e=gr,r=gr,58===t.charCodeAt(gr)?(n=lt,gr++):(n=q,0===Nr&&u(ft)),n!==q?(o=k(),o!==q?(br=r,n=pt(o),r=n):(gr=r,r=q)):(gr=r,r=q),r===q&&(r=null),r!==q&&(br=e,r=dt(r)),e=r}function m(){var e,r,n,o,i,s,c;if(Nr++,e=gr,r=[],n=gr,o=[],i=z(),i!==q)for(;i!==q;)o.push(i),i=z();else o=q;for(o!==q?(i=w(),i!==q?(61===t.charCodeAt(gr)?(s=mt,gr++):(s=q,0===Nr&&u(vt)),s!==q?(c=C(),c===q&&(c=k(),c===q&&(c=j())),c!==q?(br=n,o=yt(i,c),n=o):(gr=n,n=q)):(gr=n,n=q)):(gr=n,n=q)):(gr=n,n=q);n!==q;){if(r.push(n),n=gr,o=[],i=z(),i!==q)for(;i!==q;)o.push(i),i=z();else o=q;o!==q?(i=w(),i!==q?(61===t.charCodeAt(gr)?(s=mt,gr++):(s=q,0===Nr&&u(vt)),s!==q?(c=C(),c===q&&(c=k(),c===q&&(c=j())),c!==q?(br=n,o=yt(i,c),n=o):(gr=n,n=q)):(gr=n,n=q)):(gr=n,n=q)):(gr=n,n=q)}return r!==q&&(br=e,r=gt(r)),e=r,Nr--,e===q&&(r=q,0===Nr&&u(ht)),e}function v(){var e,r,n,o,i,s,c,l;for(Nr++,e=gr,r=[],n=gr,o=$(),o!==q?(58===t.charCodeAt(gr)?(i=lt,gr++):(i=q,0===Nr&&u(ft)),i!==q?(s=w(),s!==q?(c=G(),c!==q?(l=a(),l!==q?(br=n,o=yt(s,l),n=o):(gr=n,n=q)):(gr=n,n=q)):(gr=n,n=q)):(gr=n,n=q)):(gr=n,n=q);n!==q;)r.push(n),n=gr,o=$(),o!==q?(58===t.charCodeAt(gr)?(i=lt,gr++):(i=q,0===Nr&&u(ft)),i!==q?(s=w(),s!==q?(c=G(),c!==q?(l=a(),l!==q?(br=n,o=yt(s,l),n=o):(gr=n,n=q)):(gr=n,n=q)):(gr=n,n=q)):(gr=n,n=q)):(gr=n,n=q);return r!==q&&(br=e,r=xt(r)),e=r,Nr--,e===q&&(r=q,0===Nr&&u(bt)),e}function y(){var t,e,r,n,o;return Nr++,t=gr,e=$(),e!==q?(r=k(),r!==q?(n=b(),n!==q?(o=G(),o!==q?(br=t,e=Ct(r,n),t=e):(gr=t,t=q)):(gr=t,t=q)):(gr=t,t=q)):(gr=t,t=q),Nr--,t===q&&(e=q,0===Nr&&u(kt)),t}function g(){var e,r,n,o,i,s,c,a,l,f;if(Nr++,e=gr,r=$(),r!==q)if(62===t.charCodeAt(gr)?(n=At,gr++):(n=q,0===Nr&&u(Et)),n===q&&(43===t.charCodeAt(gr)?(n=St,gr++):(n=q,0===Nr&&u(Rt))),n!==q){for(o=[],i=z();i!==q;)o.push(i),i=z();if(o!==q)if(i=gr,s=w(),s!==q&&(br=i,s=wt(n,s)),i=s,i===q&&(i=j()),i!==q)if(s=h(),s!==q)if(c=m(),c!==q){for(a=[],l=z();l!==q;)a.push(l),l=z();a!==q?(47===t.charCodeAt(gr)?(l=rt,gr++):(l=q,0===Nr&&u(nt)),l!==q?(f=G(),f!==q?(br=e,r=Tt(n,i,s,c),e=r):(gr=e,e=q)):(gr=e,e=q)):(gr=e,e=q)}else gr=e,e=q;else gr=e,e=q;else gr=e,e=q;else gr=e,e=q}else gr=e,e=q;else gr=e,e=q;return Nr--,e===q&&(r=q,0===Nr&&u(Nt)),e}function b(){var e,r,n,o,i;for(Nr++,e=gr,r=[],n=gr,124===t.charCodeAt(gr)?(o=jt,gr++):(o=q,0===Nr&&u(Ft)),o!==q?(i=w(),i!==q?(br=n,o=pt(i),n=o):(gr=n,n=q)):(gr=n,n=q);n!==q;)r.push(n),n=gr,124===t.charCodeAt(gr)?(o=jt,gr++):(o=q,0===Nr&&u(Ft)),o!==q?(i=w(),i!==q?(br=n,o=pt(i),n=o):(gr=n,n=q)):(gr=n,n=q);return r!==q&&(br=e,r=_t(r)),e=r,Nr--,e===q&&(r=q,0===Nr&&u(Ot)),e}function x(){var e,r,n,o,i;return Nr++,e=gr,r=$(),r!==q?(126===t.charCodeAt(gr)?(n=Ut,gr++):(n=q,0===Nr&&u(Lt)),n!==q?(o=w(),o!==q?(i=G(),i!==q?(br=e,r=Dt(o),e=r):(gr=e,e=q)):(gr=e,e=q)):(gr=e,e=q)):(gr=e,e=q),Nr--,e===q&&(r=q,0===Nr&&u(Bt)),e}function k(){var t,e;return Nr++,t=gr,e=R(),e!==q&&(br=t,e=$t(e)),t=e,t===q&&(t=gr,e=w(),e!==q&&(br=t,e=Gt(e)),t=e),Nr--,t===q&&(e=q,0===Nr&&u(It)),t}function C(){var t,e;return Nr++,t=gr,e=N(),e===q&&(e=S()),e!==q&&(br=t,e=Pt(e)),t=e,Nr--,t===q&&(e=q,0===Nr&&u(Jt)),t}function N(){var e,r,n,o;return Nr++,e=gr,r=S(),r!==q?(46===t.charCodeAt(gr)?(n=zt,gr++):(n=q,0===Nr&&u(Qt)),n!==q?(o=A(),o!==q?(br=e,r=Ht(r,o),e=r):(gr=e,e=q)):(gr=e,e=q)):(gr=e,e=q),Nr--,e===q&&(r=q,0===Nr&&u(Wt)),e}function A(){var e,r,n;if(Nr++,e=gr,r=[],Zt.test(t.charAt(gr))?(n=t.charAt(gr),gr++):(n=q,0===Nr&&u(qt)),n!==q)for(;n!==q;)r.push(n),Zt.test(t.charAt(gr))?(n=t.charAt(gr),gr++):(n=q,0===Nr&&u(qt));else r=q;return r!==q&&(br=e,r=Yt(r)),e=r,Nr--,e===q&&(r=q,0===Nr&&u(Mt)),e}function E(){var e,r,n;return Nr++,e=gr,45===t.charCodeAt(gr)?(r=Vt,gr++):(r=q,0===Nr&&u(Xt)),r!==q?(n=A(),n!==q?(br=e,r=te(r,n),e=r):(gr=e,e=q)):(gr=e,e=q),Nr--,e===q&&(r=q,0===Nr&&u(Kt)),e}function S(){var t,e;return Nr++,t=E(),t===q&&(t=A()),Nr--,t===q&&(e=q,0===Nr&&u(ee)),t}function R(){var e,r,n,o;if(Nr++,e=gr,r=w(),r===q&&(r=null),r!==q){if(n=[],o=O(),o===q&&(o=T()),o!==q)for(;o!==q;)n.push(o),o=O(),o===q&&(o=T());else n=q;n!==q?(br=e,r=ne(r,n),e=r):(gr=e,e=q)}else gr=e,e=q;if(e===q)if(e=gr,46===t.charCodeAt(gr)?(r=zt,gr++):(r=q,0===Nr&&u(Qt)),r!==q){for(n=[],o=O(),o===q&&(o=T());o!==q;)n.push(o),o=O(),o===q&&(o=T());n!==q?(br=e,r=oe(n),e=r):(gr=e,e=q)}else gr=e,e=q;return Nr--,e===q&&(r=q,0===Nr&&u(re)),e}function w(){var e,r,n,o;if(Nr++,e=gr,ue.test(t.charAt(gr))?(r=t.charAt(gr),gr++):(r=q,0===Nr&&u(se)),r!==q){for(n=[],ce.test(t.charAt(gr))?(o=t.charAt(gr),gr++):(o=q,0===Nr&&u(ae));o!==q;)n.push(o),ce.test(t.charAt(gr))?(o=t.charAt(gr),gr++):(o=q,0===Nr&&u(ae));n!==q?(br=e,r=le(r,n),e=r):(gr=e,e=q)}else gr=e,e=q;return Nr--,e===q&&(r=q,0===Nr&&u(ie)),e}function T(){var e,r,n,o,i,s;if(Nr++,e=gr,r=gr,n=J(),n!==q){if(o=gr,i=[],Zt.test(t.charAt(gr))?(s=t.charAt(gr),gr++):(s=q,0===Nr&&u(qt)),s!==q)for(;s!==q;)i.push(s),Zt.test(t.charAt(gr))?(s=t.charAt(gr),gr++):(s=q,0===Nr&&u(qt));else i=q;i!==q&&(br=o,i=pe(i)),o=i,o===q&&(o=k()),o!==q?(i=P(),i!==q?(br=r,n=de(o),r=n):(gr=r,r=q)):(gr=r,r=q)}else gr=r,r=q;return r!==q?(n=O(),n===q&&(n=null),n!==q?(br=e,r=he(r,n),e=r):(gr=e,e=q)):(gr=e,e=q),Nr--,e===q&&(r=q,0===Nr&&u(fe)),e}function O(){var e,r,n,o,i;if(Nr++,e=gr,r=[],n=gr,46===t.charCodeAt(gr)?(o=zt,gr++):(o=q,0===Nr&&u(Qt)),o!==q?(i=w(),i!==q?(br=n,o=ve(i),n=o):(gr=n,n=q)):(gr=n,n=q),n!==q)for(;n!==q;)r.push(n),n=gr,46===t.charCodeAt(gr)?(o=zt,gr++):(o=q,0===Nr&&u(Qt)),o!==q?(i=w(),i!==q?(br=n,o=ve(i),n=o):(gr=n,n=q)):(gr=n,n=q);else r=q;return r!==q?(n=T(),n===q&&(n=null),n!==q?(br=e,r=ye(r,n),e=r):(gr=e,e=q)):(gr=e,e=q),Nr--,e===q&&(r=q,0===Nr&&u(me)),e}function j(){var e,r,n,o;if(Nr++,e=gr,34===t.charCodeAt(gr)?(r=be,gr++):(r=q,0===Nr&&u(xe)),r!==q?(34===t.charCodeAt(gr)?(n=be,gr++):(n=q,0===Nr&&u(xe)),n!==q?(br=e,r=ke(),e=r):(gr=e,e=q)):(gr=e,e=q),e===q&&(e=gr,34===t.charCodeAt(gr)?(r=be,gr++):(r=q,0===Nr&&u(xe)),r!==q?(n=B(),n!==q?(34===t.charCodeAt(gr)?(o=be,gr++):(o=q,0===Nr&&u(xe)),o!==q?(br=e,r=Ce(n),e=r):(gr=e,e=q)):(gr=e,e=q)):(gr=e,e=q),e===q))if(e=gr,34===t.charCodeAt(gr)?(r=be,gr++):(r=q,0===Nr&&u(xe)),r!==q){if(n=[],o=F(),o!==q)for(;o!==q;)n.push(o),o=F();else n=q;n!==q?(34===t.charCodeAt(gr)?(o=be,gr++):(o=q,0===Nr&&u(xe)),o!==q?(br=e,r=Ne(n),e=r):(gr=e,e=q)):(gr=e,e=q)}else gr=e,e=q;return Nr--,e===q&&(r=q,0===Nr&&u(ge)),e}function F(){var t,e;return t=x(),t===q&&(t=y(),t===q&&(t=gr,e=B(),e!==q&&(br=t,e=Ae(e)),t=e)),t}function _(){var e,r,n,o,i,s,c,a;if(Nr++,e=gr,r=W(),r!==q){for(n=[],o=z();o!==q;)n.push(o),o=z();n!==q?(br=e,r=Se(r,n),e=r):(gr=e,e=q)}else gr=e,e=q;if(e===q){if(e=gr,r=[],n=gr,o=gr,Nr++,i=I(),Nr--,i===q?o=void 0:(gr=o,o=q),o!==q?(i=gr,Nr++,s=L(),Nr--,s===q?i=void 0:(gr=i,i=q),i!==q?(s=gr,Nr++,c=D(),Nr--,c===q?s=void 0:(gr=s,s=q),s!==q?(c=gr,Nr++,a=W(),Nr--,a===q?c=void 0:(gr=c,c=q),c!==q?(t.length>gr?(a=t.charAt(gr),gr++):(a=q,0===Nr&&u(Re)),a!==q?(br=n,o=we(a),n=o):(gr=n,n=q)):(gr=n,n=q)):(gr=n,n=q)):(gr=n,n=q)):(gr=n,n=q),n!==q)for(;n!==q;)r.push(n),n=gr,o=gr,Nr++,i=I(),Nr--,i===q?o=void 0:(gr=o,o=q),o!==q?(i=gr,Nr++,s=L(),Nr--,s===q?i=void 0:(gr=i,i=q),i!==q?(s=gr,Nr++,c=D(),Nr--,c===q?s=void 0:(gr=s,s=q),s!==q?(c=gr,Nr++,a=W(),Nr--,a===q?c=void 0:(gr=c,c=q),c!==q?(t.length>gr?(a=t.charAt(gr),gr++):(a=q,0===Nr&&u(Re)),a!==q?(br=n,o=we(a),n=o):(gr=n,n=q)):(gr=n,n=q)):(gr=n,n=q)):(gr=n,n=q)):(gr=n,n=q);else r=q;r!==q&&(br=e,r=Te(r)),e=r}return Nr--,e===q&&(r=q,0===Nr&&u(Ee)),e}function B(){var e,r,n,o,i;if(Nr++,e=gr,r=[],n=gr,o=gr,Nr++,i=I(),Nr--,i===q?o=void 0:(gr=o,o=q),o!==q?(i=U(),i===q&&(je.test(t.charAt(gr))?(i=t.charAt(gr),gr++):(i=q,0===Nr&&u(Fe))),i!==q?(br=n,o=we(i),n=o):(gr=n,n=q)):(gr=n,n=q),n!==q)for(;n!==q;)r.push(n),n=gr,o=gr,Nr++,i=I(),Nr--,i===q?o=void 0:(gr=o,o=q),o!==q?(i=U(),i===q&&(je.test(t.charAt(gr))?(i=t.charAt(gr),gr++):(i=q,0===Nr&&u(Fe))),i!==q?(br=n,o=we(i),n=o):(gr=n,n=q)):(gr=n,n=q);else r=q;return r!==q&&(br=e,r=_e(r)),e=r,Nr--,e===q&&(r=q,0===Nr&&u(Oe)),e}function U(){var e,r;return e=gr,t.substr(gr,2)===Be?(r=Be,gr+=2):(r=q,0===Nr&&u(Ue)),r!==q&&(br=e,r=Le()),e=r}function L(){var e,r,n,o,i,s;if(Nr++,e=gr,t.substr(gr,2)===Ie?(r=Ie,gr+=2):(r=q,0===Nr&&u($e)),r!==q){for(n=[],o=gr,i=gr,Nr++,t.substr(gr,2)===Ge?(s=Ge,gr+=2):(s=q,0===Nr&&u(Je)),Nr--,s===q?i=void 0:(gr=i,i=q),i!==q?(t.length>gr?(s=t.charAt(gr),gr++):(s=q,0===Nr&&u(Re)),s!==q?(br=o,i=Pe(s),o=i):(gr=o,o=q)):(gr=o,o=q);o!==q;)n.push(o),o=gr,i=gr,Nr++,t.substr(gr,2)===Ge?(s=Ge,gr+=2):(s=q,0===Nr&&u(Je)),Nr--,s===q?i=void 0:(gr=i,i=q),i!==q?(t.length>gr?(s=t.charAt(gr),gr++):(s=q,0===Nr&&u(Re)),s!==q?(br=o,i=Pe(s),o=i):(gr=o,o=q)):(gr=o,o=q);n!==q?(t.substr(gr,2)===Ge?(o=Ge,gr+=2):(o=q,0===Nr&&u(Je)),o!==q?(br=e,r=We(n),e=r):(gr=e,e=q)):(gr=e,e=q)}else gr=e,e=q;return Nr--,e===q&&(r=q,0===Nr&&u(De)),e}function D(){var e,r,n,o,i,s;if(Nr++,e=gr,t.substr(gr,2)===Qe?(r=Qe,gr+=2):(r=q,0===Nr&&u(He)),r!==q){for(n=[],o=gr,i=gr,Nr++,t.substr(gr,2)===Me?(s=Me,gr+=2):(s=q,0===Nr&&u(Ze)),Nr--,s===q?i=void 0:(gr=i,i=q),i!==q?(t.length>gr?(s=t.charAt(gr),gr++):(s=q,0===Nr&&u(Re)),s!==q?(br=o,i=we(s),o=i):(gr=o,o=q)):(gr=o,o=q);o!==q;)n.push(o),o=gr,i=gr,Nr++,t.substr(gr,2)===Me?(s=Me,gr+=2):(s=q,0===Nr&&u(Ze)),Nr--,s===q?i=void 0:(gr=i,i=q),i!==q?(t.length>gr?(s=t.charAt(gr),gr++):(s=q,0===Nr&&u(Re)),s!==q?(br=o,i=we(s),o=i):(gr=o,o=q)):(gr=o,o=q);n!==q?(t.substr(gr,2)===Me?(o=Me,gr+=2):(o=q,0===Nr&&u(Ze)),o!==q?(br=e,r=qe(n),e=r):(gr=e,e=q)):(gr=e,e=q)}else gr=e,e=q;return Nr--,e===q&&(r=q,0===Nr&&u(ze)),e}function I(){var e,r,n,o,i,s,c,a,l,f;if(e=gr,r=$(),r!==q){for(n=[],o=z();o!==q;)n.push(o),o=z();if(n!==q)if(Ye.test(t.charAt(gr))?(o=t.charAt(gr),gr++):(o=q,0===Nr&&u(Ke)),o!==q){for(i=[],s=z();s!==q;)i.push(s),s=z();if(i!==q){if(s=[],c=gr,a=gr,Nr++,l=G(),Nr--,l===q?a=void 0:(gr=a,a=q),a!==q?(l=gr,Nr++,f=W(),Nr--,f===q?l=void 0:(gr=l,l=q),l!==q?(t.length>gr?(f=t.charAt(gr),gr++):(f=q,0===Nr&&u(Re)),f!==q?(a=[a,l,f],c=a):(gr=c,c=q)):(gr=c,c=q)):(gr=c,c=q),c!==q)for(;c!==q;)s.push(c),c=gr,a=gr,Nr++,l=G(),Nr--,l===q?a=void 0:(gr=a,a=q),a!==q?(l=gr,Nr++,f=W(),Nr--,f===q?l=void 0:(gr=l,l=q),l!==q?(t.length>gr?(f=t.charAt(gr),gr++):(f=q,0===Nr&&u(Re)),f!==q?(a=[a,l,f],c=a):(gr=c,c=q)):(gr=c,c=q)):(gr=c,c=q);else s=q;if(s!==q){for(c=[],a=z();a!==q;)c.push(a),a=z();c!==q?(a=G(),a!==q?(r=[r,n,o,i,s,c,a],e=r):(gr=e,e=q)):(gr=e,e=q)}else gr=e,e=q}else gr=e,e=q}else gr=e,e=q;else gr=e,e=q}else gr=e,e=q;return e===q&&(e=y()),e}function $(){var e;return 123===t.charCodeAt(gr)?(e=Ve,gr++):(e=q,0===Nr&&u(Xe)),e}function G(){var e;return 125===t.charCodeAt(gr)?(e=tr,gr++):(e=q,0===Nr&&u(er)),e}function J(){var e;return 91===t.charCodeAt(gr)?(e=rr,gr++):(e=q,0===Nr&&u(nr)),e}function P(){var e;return 93===t.charCodeAt(gr)?(e=or,gr++):(e=q,0===Nr&&u(ir)),e}function W(){var e;return 10===t.charCodeAt(gr)?(e=ur,gr++):(e=q,0===Nr&&u(sr)),e===q&&(t.substr(gr,2)===cr?(e=cr,gr+=2):(e=q,0===Nr&&u(ar)),e===q&&(13===t.charCodeAt(gr)?(e=lr,gr++):(e=q,0===Nr&&u(fr)),e===q&&(8232===t.charCodeAt(gr)?(e=pr,gr++):(e=q,0===Nr&&u(dr)),e===q&&(8233===t.charCodeAt(gr)?(e=hr,gr++):(e=q,0===Nr&&u(mr)))))),e}function z(){var e;return vr.test(t.charAt(gr))?(e=t.charAt(gr),gr++):(e=q,0===Nr&&u(yr)),e===q&&(e=W()),e}function Q(t){return parseInt(t.join(""),10)}function H(t){return t.concat([["line",r().start.line],["col",r().start.column]])}var M,Z=arguments.length>1?arguments[1]:{},q={},Y={start:c},K=c,V=function(t){var e=["body"].concat(t);return H(e)},X={type:"other",description:"section"},tt=function(t,e,r,o){return o&&t[1].text===o.text||n("Expected end tag for "+t[1].text+" but it was not found."),!0},et=function(t,e,r,n){return r.push(["param",["literal","block"],e]),t.push(r,["filters"]),H(t)},rt="/",nt={type:"literal",value:"/",description:'"/"'},ot=function(t){return t.push(["bodies"],["filters"]),H(t)},it=/^[#?\^<+@%]/,ut={type:"class",value:"[#?^<+@%]",description:"[#?^<+@%]"},st=function(t,e,r,n){return[t,e,r,n]},ct={type:"other",description:"end tag"},at=function(t){return t},lt=":",ft={type:"literal",value:":",description:'":"'},pt=function(t){return t},dt=function(t){return t?["context",t]:["context"]},ht={type:"other",description:"params"},mt="=",vt={type:"literal",value:"=",description:'"="'},yt=function(t,e){return["param",["literal",t],e]},gt=function(t){return["params"].concat(t)},bt={type:"other",description:"bodies"},xt=function(t){return["bodies"].concat(t)},kt={type:"other",description:"reference"},Ct=function(t,e){return H(["reference",t,e])},Nt={type:"other",description:"partial"},At=">",Et={type:"literal",value:">",description:'">"'},St="+",Rt={type:"literal",value:"+",description:'"+"'},wt=function(t,e){return["literal",e]},Tt=function(t,e,r,n){var o=">"===t?"partial":t;return H([o,e,r,n])},Ot={type:"other",description:"filters"},jt="|",Ft={type:"literal",value:"|",description:'"|"'},_t=function(t){return["filters"].concat(t)},Bt={type:"other",description:"special"},Ut="~",Lt={type:"literal",value:"~",description:'"~"'},Dt=function(t){return H(["special",t])},It={type:"other",description:"identifier"},$t=function(t){var e=["path"].concat(t);return e.text=t[1].join(".").replace(/,line,\d+,col,\d+/g,""),e},Gt=function(t){var e=["key",t];return e.text=t,e},Jt={type:"other",description:"number"},Pt=function(t){return["literal",t]},Wt={type:"other",description:"float"},zt=".",Qt={type:"literal",value:".",description:'"."'},Ht=function(t,e){return parseFloat(t+"."+e)},Mt={type:"other",description:"unsigned_integer"},Zt=/^[0-9]/,qt={type:"class",value:"[0-9]",description:"[0-9]"},Yt=function(t){return Q(t)},Kt={type:"other",description:"signed_integer"},Vt="-",Xt={type:"literal",value:"-",description:'"-"'},te=function(t,e){return-1*e},ee={type:"other",description:"integer"},re={type:"other",description:"path"},ne=function(t,e){return e=e[0],t&&e?(e.unshift(t),H([!1,e])):H([!0,e])},oe=function(t){return H(t.length>0?[!0,t[0]]:[!0,[]])},ie={type:"other",description:"key"},ue=/^[a-zA-Z_$]/,se={type:"class",value:"[a-zA-Z_$]",description:"[a-zA-Z_$]"},ce=/^[0-9a-zA-Z_$\-]/,ae={type:"class",value:"[0-9a-zA-Z_$-]",description:"[0-9a-zA-Z_$-]"},le=function(t,e){return t+e.join("")},fe={type:"other",description:"array"},pe=function(t){return t.join("")},de=function(t){return t},he=function(t,e){return e?e.unshift(t):e=[t],e},me={type:"other",description:"array_part"},ve=function(t){return t},ye=function(t,e){return e?t.concat(e):t},ge={type:"other",description:"inline"},be='"',xe={type:"literal",value:'"',description:'"\\""'},ke=function(){return H(["literal",""])},Ce=function(t){return H(["literal",t])},Ne=function(t){return H(["body"].concat(t))},Ae=function(t){return["buffer",t]},Ee={type:"other",description:"buffer"},Se=function(t,e){return H(["format",t,e.join("")])},Re={type:"any",description:"any character"},we=function(t){return t},Te=function(t){return H(["buffer",t.join("")])},Oe={type:"other",description:"literal"},je=/^[^"]/,Fe={type:"class",value:'[^"]',description:'[^"]'},_e=function(t){return t.join("")},Be='\\"',Ue={type:"literal",value:'\\"',description:'"\\\\\\""'},Le=function(){return'"'},De={type:"other",
description:"raw"},Ie="{`",$e={type:"literal",value:"{`",description:'"{`"'},Ge="`}",Je={type:"literal",value:"`}",description:'"`}"'},Pe=function(t){return t},We=function(t){return H(["raw",t.join("")])},ze={type:"other",description:"comment"},Qe="{!",He={type:"literal",value:"{!",description:'"{!"'},Me="!}",Ze={type:"literal",value:"!}",description:'"!}"'},qe=function(t){return H(["comment",t.join("")])},Ye=/^[#?\^><+%:@\/~%]/,Ke={type:"class",value:"[#?^><+%:@/~%]",description:"[#?^><+%:@/~%]"},Ve="{",Xe={type:"literal",value:"{",description:'"{"'},tr="}",er={type:"literal",value:"}",description:'"}"'},rr="[",nr={type:"literal",value:"[",description:'"["'},or="]",ir={type:"literal",value:"]",description:'"]"'},ur="\n",sr={type:"literal",value:"\n",description:'"\\n"'},cr="\r\n",ar={type:"literal",value:"\r\n",description:'"\\r\\n"'},lr="\r",fr={type:"literal",value:"\r",description:'"\\r"'},pr="\u2028",dr={type:"literal",value:"\u2028",description:'"\\u2028"'},hr="\u2029",mr={type:"literal",value:"\u2029",description:'"\\u2029"'},vr=/^[\t\x0B\f \xA0\uFEFF]/,yr={type:"class",value:"[\\t\\v\\f \\u00A0\\uFEFF]",description:"[\\t\\v\\f \\u00A0\\uFEFF]"},gr=0,br=0,xr=[{line:1,column:1,seenCR:!1}],kr=0,Cr=[],Nr=0;if("startRule"in Z){if(!(Z.startRule in Y))throw new Error("Can't start parsing from rule \""+Z.startRule+'".');K=Y[Z.startRule]}if(M=K(),M!==q&&gr===t.length)return M;throw M!==q&&gr<t.length&&u({type:"end",description:"end of input"}),s(null,Cr,kr<t.length?t.charAt(kr):null,kr<t.length?i(kr,kr+1):i(kr,kr))}return t(e,Error),{SyntaxError:e,parse:r}}();return t.parse=e.parse,e}),function(t,e){"function"==typeof define&&define.amd&&define.amd.dust===!0?define("dust.compile",["dust.core","dust.parse"],function(t,r){return e(r,t).compile}):"object"==typeof exports?module.exports=e(require("./parser").parse,require("./dust")):e(t.dust.parse,t.dust)}(this,function(t,e){function r(t){var e={};return g.filterNode(e,t)}function n(t,e){var r,n,o,i=[e[0]];for(r=1,n=e.length;n>r;r++)o=g.filterNode(t,e[r]),o&&i.push(o);return i}function o(t,e){var r,n,o,i,u=[e[0]];for(n=1,o=e.length;o>n;n++)i=g.filterNode(t,e[n]),i&&("buffer"===i[0]||"format"===i[0]?r?(r[0]="buffer"===i[0]?"buffer":r[0],r[1]+=i.slice(1,-2).join("")):(r=i,u.push(i)):(r=null,u.push(i)));return u}function i(t,e){return["buffer",x[e[1]],e[2],e[3]]}function u(t,e){return e}function s(){}function c(t,r){return e.config.whitespace?(r.splice(1,2,r.slice(1,-2).join("")),r):null}function a(t,r){var n,o={name:r,bodies:[],blocks:{},index:0,auto:"h"},i=e.escapeJs(r),u=r?'"'+i+'",':"",s="function(dust){",c=g.compileNode(o,t);return r&&(s+='dust.register("'+i+'",'+c+");"),s+=l(o)+f(o)+"return "+c+"}",n="("+s+"(dust));",e.config.amd?"define("+u+'["dust.core"],'+s+");":e.config.cjs?"module.exports=function(dust){var tmpl="+n+"var f="+y().toString()+";f.template=tmpl;return f}":n}function l(t){var e,r=[],n=t.blocks;for(e in n)r.push('"'+e+'":'+n[e]);return r.length?(t.blocks="ctx=ctx.shiftBlocks(blocks);","var blocks={"+r.join(",")+"};"):(t.blocks="",t.blocks)}function f(t){var e,r,n=[],o=t.bodies,i=t.blocks;for(e=0,r=o.length;r>e;e++)n[e]="function body_"+e+"(chk,ctx){"+i+"return chk"+o[e]+";}body_"+e+".__dustBody=!0;";return n.join("")}function p(t,e){var r,n,o="";for(r=1,n=e.length;n>r;r++)o+=g.compileNode(t,e[r]);return o}function d(t,r,n){return"."+(e._aliases[n]||n)+"("+g.compileNode(t,r[1])+","+g.compileNode(t,r[2])+","+g.compileNode(t,r[4])+","+g.compileNode(t,r[3])+")"}function h(t){return t.replace(k,"\\\\").replace(C,'\\"').replace(N,"\\f").replace(A,"\\n").replace(E,"\\r").replace(S,"\\t")}function m(t,r,n){var o=e.loadSource(e.compile(t));return y(o)(r,n)}function v(t,r){var n=e.loadSource(e.compile(t,r));return y(n)}function y(t){return function(r,n){var o=n?"render":"stream";return e[o](t,r,n)}}var g={},b=e.isArray;g.compile=function(e,n){try{var o=r(t(e));return a(o,n)}catch(i){if(!i.location)throw i;throw new SyntaxError(i.message+" ["+n+":"+i.location.start.line+":"+i.location.start.column+"]")}},g.filterNode=function(t,e){return g.optimizers[e[0]](t,e)},g.optimizers={body:o,buffer:u,special:i,format:c,reference:n,"#":n,"?":n,"^":n,"<":n,"+":n,"@":n,"%":n,partial:n,context:n,params:n,bodies:n,param:n,filters:u,key:u,path:u,literal:u,raw:u,comment:s,line:s,col:s},g.pragmas={esc:function(t,e,r){var n,o=t.auto;return e||(e="h"),t.auto="s"===e?"":e,n=p(t,r.block),t.auto=o,n}};var x={s:" ",n:"\n",r:"\r",lb:"{",rb:"}"};g.compileNode=function(t,e){return g.nodes[e[0]](t,e)},g.nodes={body:function(t,e){var r=t.index++,n="body_"+r;return t.bodies[r]=p(t,e),n},buffer:function(t,e){return".w("+R(e[1])+")"},format:function(t,e){return".w("+R(e[1])+")"},reference:function(t,e){return".f("+g.compileNode(t,e[1])+",ctx,"+g.compileNode(t,e[2])+")"},"#":function(t,e){return d(t,e,"section")},"?":function(t,e){return d(t,e,"exists")},"^":function(t,e){return d(t,e,"notexists")},"<":function(t,e){for(var r=e[4],n=1,o=r.length;o>n;n++){var i=r[n],u=i[1][1];if("block"===u)return t.blocks[e[1].text]=g.compileNode(t,i[2]),""}return""},"+":function(t,e){return"undefined"==typeof e[1].text&&"undefined"==typeof e[4]?".b(ctx.getBlock("+g.compileNode(t,e[1])+",chk, ctx),"+g.compileNode(t,e[2])+", {},"+g.compileNode(t,e[3])+")":".b(ctx.getBlock("+R(e[1].text)+"),"+g.compileNode(t,e[2])+","+g.compileNode(t,e[4])+","+g.compileNode(t,e[3])+")"},"@":function(t,e){return".h("+R(e[1].text)+","+g.compileNode(t,e[2])+","+g.compileNode(t,e[4])+","+g.compileNode(t,e[3])+","+g.compileNode(t,e[5])+")"},"%":function(t,e){var r,n,o,i,u,s,c,a,l,f=e[1][1];if(!g.pragmas[f])return"";for(r=e[4],n={},a=1,l=r.length;l>a;a++)s=r[a],n[s[1][1]]=s[2];for(o=e[3],i={},a=1,l=o.length;l>a;a++)c=o[a],i[c[1][1]]=c[2][1];return u=e[2][1]?e[2][1].text:null,g.pragmas[f](t,u,n,i)},partial:function(t,e){return".p("+g.compileNode(t,e[1])+",ctx,"+g.compileNode(t,e[2])+","+g.compileNode(t,e[3])+")"},context:function(t,e){return e[1]?"ctx.rebase("+g.compileNode(t,e[1])+")":"ctx"},params:function(t,e){for(var r=[],n=1,o=e.length;o>n;n++)r.push(g.compileNode(t,e[n]));return r.length?"{"+r.join(",")+"}":"{}"},bodies:function(t,e){for(var r=[],n=1,o=e.length;o>n;n++)r.push(g.compileNode(t,e[n]));return"{"+r.join(",")+"}"},param:function(t,e){return g.compileNode(t,e[1])+":"+g.compileNode(t,e[2])},filters:function(t,e){for(var r=[],n=1,o=e.length;o>n;n++){var i=e[n];r.push('"'+i+'"')}return'"'+t.auto+'"'+(r.length?",["+r.join(",")+"]":"")},key:function(t,e){return'ctx.get(["'+e[1]+'"], false)'},path:function(t,e){for(var r=e[1],n=e[2],o=[],i=0,u=n.length;u>i;i++)b(n[i])?o.push(g.compileNode(t,n[i])):o.push('"'+n[i]+'"');return"ctx.getPath("+r+", ["+o.join(",")+"])"},literal:function(t,e){return R(e[1])},raw:function(t,e){return".w("+R(e[1])+")"}};var k=/\\/g,C=/"/g,N=/\f/g,A=/\n/g,E=/\r/g,S=/\t/g,R="undefined"==typeof JSON?function(t){return'"'+h(t)+'"'}:JSON.stringify;return e.compiler=g,e.compile=e.compiler.compile,e.renderSource=m,e.compileFn=v,e.filterNode=g.filterNode,e.optimizers=g.optimizers,e.pragmas=g.pragmas,e.compileNode=g.compileNode,e.nodes=g.nodes,g}),"function"==typeof define&&define.amd&&define.amd.dust===!0&&define(["require","dust.core","dust.compile"],function(t,e){return e.onLoad=function(e,r){t([e],function(t){r(null,t)})},e});